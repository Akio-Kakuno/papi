<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE>PAPI USER'S GUIDE</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 2.0  (Linux)">
	<META NAME="AUTHOR" CONTENT="lparker">
	<META NAME="CREATED" CONTENT="20061103;160000">
	<META NAME="CHANGEDBY" CONTENT="Dan Terpstra">
	<META NAME="CHANGED" CONTENT="20061103;160000">
	<STYLE>
	<!--
		@page { size: 8.5in 11in; margin-right: 0.75in; margin-top: 0.5in; margin-bottom: 0.5in }
		P { margin-bottom: 0.17in; direction: ltr; color: #000000; widows: 2; orphans: 2 }
		P.western { font-family: "Verdana", sans-serif; font-size: 12pt; so-language: en-US }
		P.cjk { font-family: "Times New Roman", serif; font-size: 12pt }
		P.ctl { font-family: "Times New Roman", serif; font-size: 12pt; so-language: ar-SA }
		H1 { margin-top: 0.33in; margin-bottom: 0.19in; direction: ltr; color: #000000; widows: 2; orphans: 2; text-decoration: underline }
		H1.western { font-family: "Verdana", sans-serif; font-size: 18pt; so-language: en-US }
		H1.cjk { font-family: "Times New Roman", serif; font-size: 18pt }
		H1.ctl { font-family: "Times New Roman", serif; font-size: 12pt; so-language: ar-SA; font-weight: medium }
		H2 { margin-top: 0.25in; margin-bottom: 0.19in; direction: ltr; color: #000000; widows: 2; orphans: 2 }
		H2.western { font-family: "Verdana", sans-serif; font-size: 16pt; so-language: en-US }
		H2.cjk { font-family: "Times New Roman", serif; font-size: 16pt }
		H2.ctl { font-family: "Times New Roman", serif; font-size: 12pt; so-language: ar-SA; font-weight: medium }
		H3 { margin-bottom: 0.19in; direction: ltr; color: #000000; widows: 2; orphans: 2 }
		H3.western { font-family: "Verdana", sans-serif; so-language: en-US }
		H3.cjk { font-family: "Times New Roman", serif }
		H3.ctl { font-family: "Times New Roman", serif; font-size: 12pt; so-language: ar-SA }
		H4 { margin-top: 0in; margin-bottom: 0.19in; direction: ltr; color: #000000; text-align: justify; widows: 2; orphans: 2 }
		H4.western { font-family: "Verdana", sans-serif; so-language: en-US }
		H4.cjk { font-family: "Times New Roman", serif }
		H4.ctl { font-family: "Times New Roman", serif; so-language: ar-SA }
		A:link { color: #0000ff }
		A:visited { color: #800080 }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" TEXT="#000000" LINK="#0000ff" VLINK="#800080" DIR="LTR">
<DIV TYPE=HEADER>
	<P STYLE="margin-bottom: 0.21in; border-top: none; border-bottom: 1px solid #000000; border-left: none; border-right: none; padding-top: 0in; padding-bottom: 0.01in; padding-left: 0in; padding-right: 0in">
	PAPI User’s Guide 		Version 3.5.0</P>
</DIV>
<P ALIGN=CENTER STYLE="margin-top: 0.17in; margin-bottom: 0.04in"><FONT SIZE=7><B>PAPI
USER’S GUIDE</B></FONT></P>
<H1 CLASS="western"><A NAME="1.TABLE OF CONTENTS	|outline"></A>TABLE
OF CONTENTS	</H1>
<DIV ID="Table of Contents1" DIR="LTR">
	<P STYLE="margin-bottom: 0in"><FONT SIZE=4 STYLE="font-size: 16pt"><B>PAPI
	USER’S GUIDE	1</B></FONT></P>
	<P STYLE="margin-bottom: 0in"><FONT SIZE=4 STYLE="font-size: 16pt"><B><A HREF="#1.TABLE OF CONTENTS	|outline">TABLE
	OF CONTENTS 	1</A></B></FONT></P>
	<P STYLE="margin-bottom: 0in"><FONT SIZE=4 STYLE="font-size: 16pt"><B><A HREF="#2.PREFACE	|outline">PREFACE
		4</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#2.1.INTENDED AUDIENCE|outline">INTENDED
	AUDIENCE	4</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#2.2.ORGANIZATION OF THIS DOCUMENT|outline">ORGANIZATION
	OF THIS DOCUMENT	4</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#2.2.1.INTRODUCTION TO PAPI|outline">INTRODUCTION TO
	PAPI	4</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#2.2.2.INSTALLING PAPI|outline">INSTALLING PAPI	4</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#2.2.3.C AND FORTRAN CALLING INTERFACES|outline">C AND
	FORTRAN CALLING INTERFACES	4</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#2.2.4.EVENTS|outline">EVENTS	4</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#2.2.5.PAPI COUNTER INTERFACES|outline">PAPI COUNTER
	INTERFACES	4</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#2.2.6.PAPI TIMERS|outline">PAPI TIMERS	5</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#2.2.7.PAPI SYSTEM INFORMATION|outline">PAPI SYSTEM
	INFORMATION	5</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#2.2.8.ADVANCED PAPI FEATURES|outline">ADVANCED PAPI
	FEATURES	5</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#2.2.9.PAPI ERROR HANDLING|outline">PAPI ERROR
	HANDLING	5</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#2.2.10.PAPI MAILING LISTS|outline">PAPI MAILING LISTS	5</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#2.2.11.APPENDICES|outline">APPENDICES	5</A></I></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#2.3.DOCUMENT CONVENTION|outline">DOCUMENT
	CONVENTION	5</A></B></FONT></P>
	<P STYLE="margin-bottom: 0in"><FONT SIZE=4 STYLE="font-size: 16pt"><B><A HREF="#3.INTRODUCTION TO PAPI	|outline">INTRODUCTION
	TO PAPI 	6</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#3.1.WHAT IS PAPI_|outline">WHAT
	IS PAPI?	6</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#3.2.BACKGROUND |outline">BACKGROUND
		6</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#3.3.ARCHITECTURE|outline">ARCHITECTURE	7</A></B></FONT></P>
	<P STYLE="margin-bottom: 0in"><FONT SIZE=4 STYLE="font-size: 16pt"><B><A HREF="#4.INSTALLING PAPI	|outline">INSTALLING
	PAPI 	8</A></B></FONT></P>
	<P STYLE="margin-bottom: 0in"><FONT SIZE=4 STYLE="font-size: 16pt"><B><A HREF="#5.C AND FORTRAN CALLING INTERFACES	|outline">C
	AND FORTRAN CALLING INTERFACES 	9</A></B></FONT></P>
	<P STYLE="margin-bottom: 0in"><FONT SIZE=4 STYLE="font-size: 16pt"><B><A HREF="#6.EVENTS	|outline">EVENTS
		10</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#6.1.WHAT ARE EVENTS_|outline">WHAT
	ARE EVENTS?	10</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#6.2.NATIVE EVENTS|outline">NATIVE
	EVENTS	10</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#6.2.1.WHAT ARE NATIVE EVENTS_|outline">WHAT ARE NATIVE
	EVENTS?	10</A></I></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#6.3.PRESET EVENTS|outline">PRESET
	EVENTS	11</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#6.3.1.WHAT ARE PRESET EVENTS_|outline">WHAT ARE PRESET
	EVENTS?	11</A></I></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#6.4.EVENT QUERY|outline">EVENT
	QUERY	12</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#6.5.EVENT TRANSLATION|outline">EVENT
	TRANSLATION	15</A></B></FONT></P>
	<P STYLE="margin-bottom: 0in"><FONT SIZE=4 STYLE="font-size: 16pt"><B><A HREF="#7.PAPI’S COUNTER INTERFACES	|outline">PAPI’S
	COUNTER INTERFACES 	17</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#7.1.HIGH-LEVEL API|outline">HIGH-LEVEL
	API	17</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.1.1.WHAT IS THE HIGH-LEVEL API_|outline">WHAT IS THE
	HIGH-LEVEL API?	17</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.1.2.INITIALIZING THE HIGH-LEVEL API|outline">INITIALIZING
	THE HIGH-LEVEL API	17</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.1.3.EXECUTION RATE CALLS	|outline">EXECUTION RATE
	CALLS 	19</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.1.4.READING, ACCUMULATING, AND STOPPING COUNTERS|outline">READING,
	ACCUMULATING, AND STOPPING COUNTERS	20</A></I></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#7.2.LOW-LEVEL API|outline">LOW-LEVEL
	API	21</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.2.1.WHAT IS THE LOW-LEVEL API_|outline">WHAT IS THE
	LOW-LEVEL API?	21</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.2.2.INITIALIZATION OF THE LOW-LEVEL API|outline">INITIALIZATION
	OF THE LOW-LEVEL API	22</A></I></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#7.3.EVENT SETS|outline">EVENT
	SETS	24</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.3.1.WHAT ARE EVENT SETS_|outline">WHAT ARE EVENT
	SETS?	24</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.3.2.CREATING AN EVENT SET|outline">CREATING AN EVENT
	SET	24</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.3.3.ADDING EVENTS TO AN EVENT SET|outline">ADDING
	EVENTS TO AN EVENT SET	24</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.3.4.STARTING, READING, ADDING, AND STOPPING EVENTS IN AN EVENT SET|outline">STARTING,
	READING, ADDING, AND STOPPING EVENTS IN AN EVENT SET	26</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.3.5.RESETTING EVENTS IN AN EVENT SET|outline">RESETTING
	EVENTS IN AN EVENT SET	27</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.3.6.REMOVING EVENTS IN AN EVENT SET|outline">REMOVING
	EVENTS IN AN EVENT SET	28</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.3.7.EMPTYING AND DESTROYING AN EVENT SET|outline">EMPTYING
	AND DESTROYING AN EVENT SET	29</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.3.8.THE STATE OF AN EVENT SET|outline">THE STATE OF
	AN EVENT SET	30</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.3.9.GETTING AND SETTING OPTIONS|outline">GETTING AND
	SETTING OPTIONS	33</A></I></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#7.4.SIMPLE CODE EXAMPLES|outline">SIMPLE
	CODE EXAMPLES	40</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.4.1.HIGH-LEVEL API|outline">HIGH-LEVEL API	40</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#7.4.2.LOW-LEVEL API|outline">LOW-LEVEL API	41</A></I></P>
	<P STYLE="margin-bottom: 0in"><FONT SIZE=4 STYLE="font-size: 16pt"><B><A HREF="#8.PAPI TIMERS	|outline">PAPI
	TIMERS 	43</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#8.1.REAL TIME|outline">REAL
	TIME	43</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#8.2.VIRTUAL TIME|outline">VIRTUAL
	TIME	44</A></B></FONT></P>
	<P STYLE="margin-bottom: 0in"><FONT SIZE=4 STYLE="font-size: 16pt"><B><A HREF="#9.PAPI SYSTEM INFORMATION	|outline">PAPI
	SYSTEM INFORMATION 	46</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#9.1.EXECUTABLE INFORMATION|outline">EXECUTABLE
	INFORMATION	46</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#9.2.HARDWARE INFORMATION|outline">HARDWARE
	INFORMATION	47</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#9.3.SUBSTRATE INFORMATION|outline">SUBSTRATE
	INFORMATION	49</A></B></FONT></P>
	<P STYLE="margin-bottom: 0in"><FONT SIZE=4 STYLE="font-size: 16pt"><B><A HREF="#10.ADVANCED PAPI FEATURES	|outline">ADVANCED
	PAPI FEATURES 	50</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#10.1.MULTIPLEXING|outline">MULTIPLEXING	50</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#10.2.WHAT IS MULTIPLEXING_|outline">WHAT
	IS MULTIPLEXING?	50</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#10.2.1.USING PAPI WITH MULTIPLEXING|outline">USING PAPI
	WITH MULTIPLEXING	50</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#10.2.2.ISSUES OF MULTIPLEXING|outline">ISSUES OF
	MULTIPLEXING	52</A></I></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#10.3.USING PAPI WITH PARALLEL PROGRAMS|outline">USING
	PAPI WITH PARALLEL PROGRAMS	53</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#10.3.1.THREADS|outline">THREADS	53</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#10.3.2.MPI|outline">MPI	56</A></I></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#10.4.OVERFLOW|outline">OVERFLOW	58</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#10.4.1.WHAT IS AN OVERFLOW_|outline">WHAT IS AN
	OVERFLOW?	58</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#10.4.2.BEGINNING OVERFLOWS IN EVENT SETS|outline">BEGINNING
	OVERFLOWS IN EVENT SETS	58</A></I></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#10.5.STATISTICAL PROFILING|outline">STATISTICAL
	PROFILING	60</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#10.5.1.WHAT IS STATISTICAL PROFILING_|outline">WHAT IS
	STATISTICAL PROFILING?	60</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#10.5.2.GENERATING A PC HISTOGRAM|outline">GENERATING A
	PC HISTOGRAM	61</A></I></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#10.6.DATA AND INSTRUCTION ADDRESS RESTRICTION|outline">DATA
	AND INSTRUCTION ADDRESS RESTRICTION	63</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#10.6.1.Introduction|outline">Introduction	63</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#10.6.2.The PAPI Interface|outline">The PAPI
	Interface	63</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#10.6.3.Itanium Idiosyncrasies|outline">Itanium
	Idiosyncrasies	64</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#10.6.4.Supporting Software|outline">Supporting
	Software	65</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#10.6.5.The data_range.c Test Case|outline">The
	data_range.c Test Case	65</A></I></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#10.6.6.The papi_native_avail Utility|outline">The
	papi_native_avail Utility	67</A></I></P>
	<P STYLE="margin-bottom: 0in"><FONT SIZE=4 STYLE="font-size: 16pt"><B><A HREF="#11.PAPI ERROR HANDLING	|outline">PAPI
	ERROR HANDLING 	69</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#11.1.ERROR CODES|outline">ERROR
	CODES	69</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.33in; margin-bottom: 0in; font-weight: medium">
	<I><A HREF="#11.1.1.CONVERTING ERROR CODES TO ERROR MESSAGES|outline">CONVERTING
	ERROR CODES TO ERROR MESSAGES	69</A></I></P>
	<P STYLE="margin-bottom: 0in"><FONT SIZE=4 STYLE="font-size: 16pt"><B><A HREF="#12.FURTHER INFORMATION	|outline">FURTHER
	INFORMATION 	72</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#12.1.PAPI HOME PAGE|outline">PAPI
	HOME PAGE	72</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#12.2.PAPI MAILING LISTS|outline">PAPI
	MAILING LISTS	72</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#12.3.REPORTING BUGS|outline">REPORTING
	BUGS	72</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#12.4.PAPI PROGRAMMER’S REFERENCE|outline">PAPI
	PROGRAMMER’S REFERENCE	72</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#12.5.TABLE OF PRESET EVENTS|outline">TABLE
	OF PRESET EVENTS	73</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#12.6.SUPPORTED PLATFORMS|outline">SUPPORTED
	PLATFORMS	73</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#12.7.SUPPORTED TOOLS|outline">SUPPORTED
	TOOLS	73</A></B></FONT></P>
	<P LANG="" STYLE="margin-left: 0.17in; margin-bottom: 0in"><FONT SIZE=4><B><A HREF="#12.8.HARDWARE REFERENCES|outline">HARDWARE
	REFERENCES	73</A></B></FONT></P>
	<P STYLE="margin-bottom: 0in"><FONT SIZE=4 STYLE="font-size: 16pt"><B><A HREF="#13.BIBLIOGRAPHY	|outline">BIBLIOGRAPHY
		74</A></B></FONT></P>
</DIV>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="PREFACE"></A><A NAME="2.PREFACE	|outline"></A>
PREFACE	</H1>
<H2 CLASS="western"><A NAME="INTENDED_AUDIENCE"></A><A NAME="2.1.INTENDED AUDIENCE|outline"></A>
INTENDED AUDIENCE</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">This document is
intended to provide the PAPI user with a discussion of how to use the
different components and functions of PAPI. The intended users are
application developers and performance tool writers who need to
access performance data to tune and model application performance.
The user is expected to have some level of familiarity with either
the C or Fortran programming language.</P>
<H2 CLASS="western"><A NAME="ORGANIZATION_OF_THIS_DOCUMENT"></A><A NAME="2.2.ORGANIZATION OF THIS DOCUMENT|outline"></A>
ORGANIZATION OF THIS DOCUMENT</H2>
<H3 CLASS="western"><A NAME="2.2.1.INTRODUCTION TO PAPI|outline"></A><FONT COLOR="#0000ff"><U><A HREF="#INTRODUCTION_TO_PAPI"><FONT SIZE=3><FONT COLOR="#000000">INTRODUCTION
TO PAPI</FONT></FONT></A></U></FONT></H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">This section
provides an introduction to PAPI by describing the project, its
motivation, and its architecture. 
</P>
<H3 CLASS="western"><A NAME="_HOW_TO_INSTALL"></A><A NAME="2.2.2.INSTALLING PAPI|outline"></A>
<FONT COLOR="#0000ff"><U><A HREF="#_INSTALLING_PAPI"><FONT SIZE=3>INSTALLING
PAPI</FONT></A></U></FONT></H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">This section
provides an installation guide for PAPI. It states the necessary
steps in order to install PAPI on the various supported operating
systems.</P>
<H3 CLASS="western"><A NAME="2.2.3.C AND FORTRAN CALLING INTERFACES|outline"></A>
<FONT COLOR="#0000ff"><U><A HREF="#C_AND_FORTRAN_CALLING_INTERFACES"><FONT SIZE=3>C
AND FORTRAN CALLING INTERFACES</FONT></A></U></FONT></H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">This section states
the header files in which function calls are defined and the form of
the function calls for both the C and Fortran calling interfaces.
Also, it provides a table that shows the relation between certain
pseudo-types and Fortran variable types.</P>
<H3 CLASS="western"><A NAME="2.2.4.EVENTS|outline"></A><FONT COLOR="#0000ff"><U><A HREF="#EVENTS"><FONT SIZE=3>EVENTS</FONT></A></U></FONT></H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">This section
provides an explanation of events as well as an explanation of native
and preset events. The preset query and translation functions are
also discussed in this section. There are code examples using native
events, preset query, and preset translation with the corresponding
output.</P>
<H3 CLASS="western"><A NAME="2.2.5.PAPI COUNTER INTERFACES|outline"></A>
<FONT COLOR="#0000ff"><U><A HREF="#PAPI_COUNTER_INTERFACES"><FONT SIZE=3>PAPI
COUNTER INTERFACES</FONT></A></U></FONT></H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">This section
discusses the high-level and low-level interfaces in detail. The
initialization and functions of these interfaces are also discussed.
Code examples along with the corresponding output are included as
well.</P>
<H3 CLASS="western"><A NAME="2.2.6.PAPI TIMERS|outline"></A><FONT COLOR="#0000ff"><U><A HREF="#PAPI_TIMERS"><FONT SIZE=3>PAPI
TIMERS</FONT></A></U></FONT></H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">This section
explains the PAPI functions associated with obtaining real and
virtual time from the platform’s timers. Code examples along with
the corresponding output are included as well.</P>
<H3 CLASS="western"><A NAME="2.2.7.PAPI SYSTEM INFORMATION|outline"></A>
<FONT COLOR="#0000ff"><U><A HREF="#PAPI_SYSTEM_INFO"><FONT SIZE=3>PAPI
SYSTEM INFORMATION</FONT></A></U></FONT></H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">This section
explains the PAPI functions associated with obtaining hardware and
executable information. Code examples along with the corresponding
output are included as well.</P>
<H3 CLASS="western"><A NAME="2.2.8.ADVANCED PAPI FEATURES|outline"></A>
<FONT COLOR="#0000ff"><U><A HREF="#ADVANCED_PAPI_FEATURES"><FONT SIZE=3>ADVANCED
PAPI FEATURES</FONT></A></U></FONT></H3>
<P STYLE="margin-right: 0.5in; margin-top: 0.19in; margin-bottom: 0.19in">
This section discusses the advanced features of PAPI, which includes
multiplexing, threads, MPI, overflows, and statistical profiling. The
functions that are use to implement these features are also
discussed. Code examples along with the corresponding output are
included as well.</P>
<H3 CLASS="western"><A NAME="2.2.9.PAPI ERROR HANDLING|outline"></A><FONT COLOR="#0000ff"><U><A HREF="#PAPI_ERROR_HANDLING"><FONT SIZE=3>PAPI
ERROR HANDLING</FONT></A></U></FONT></H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">This section
discusses the various negative error codes that are returned by the
PAPI functions. A table with the names, values, and descriptions of
the return codes are given as well as a discussion of the PAPI
function that can be used to convert error codes to error messages
along with a code example with the corresponding output. 
</P>
<H3 CLASS="western"><A NAME="2.2.10.PAPI MAILING LISTS|outline"></A><FONT COLOR="#0000ff"><U><A HREF="#PAPI_MAILING_LISTS"><FONT SIZE=3>PAPI
MAILING LISTS</FONT></A></U></FONT></H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">This section
provides information on two PAPI mailing lists for the users to ask
various questions about the project.</P>
<H3 CLASS="western"><A NAME="2.2.11.APPENDICES|outline"></A><FONT COLOR="#0000ff"><U><A HREF="#APPENDICES"><FONT SIZE=3>APPENDICES</FONT></A></U></FONT></H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">These appendices
provide various listings and tables, such as:  a table of preset
events and the platforms on which they are supported, a table of PAPI
supported tools, more information on native events, multiplexing,
overflow, and etc.</P>
<H2 CLASS="western"><A NAME="DOCUMENT_CONVENTION"></A><A NAME="2.3.DOCUMENT CONVENTION|outline"></A>
DOCUMENT CONVENTION</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1)</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">	A function that
passes the argument of 1. The user should provide this function to
handle errors.</P>
<H1 CLASS="western"><A NAME="INTRODUCTION_TO_PAPI"></A><A NAME="3.INTRODUCTION TO PAPI	|outline"></A>
INTRODUCTION TO PAPI	</H1>
<H2 CLASS="western"><A NAME="WHAT_IS_PAPI"></A><A NAME="3.1.WHAT IS PAPI_|outline"></A>
WHAT IS PAPI?</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">PAPI is an acronym
for <B>P</B>erformance <B>A</B>pplication <B>P</B>rogramming
<B>I</B>nterface. The PAPI Project is being developed at the
University of Tennessee’s Innovative Computing Laboratory in the
Computer Science Department. This project was created to design,
standardize, and implement a portable and efficient API (Application
Programming Interface) to access the hardware performance counters
found on most modern microprocessors.</P>
<H2 CLASS="western"><A NAME="3.2.BACKGROUND |outline"></A>BACKGROUND 
</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Hardware counters
exist on every major processor today, such as Intel Pentium, Core,
IA-64, AMD Opteron, and IBM POWER series. These counters can provide
performance tool developers with a basis for tool development and
application developers with valuable information about sections of
their code that can be improved. However, there are only a few APIs
that allow access to these counters, and many of them are poorly
documented, unstable, or unavailable. In addition, performance
metrics may have different definitions and different programming
interfaces on different platforms.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">These considerations
motivated the development of the <FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/papi">PAPI</A></U></FONT>
Project.  Some goals of the PAPI Project are as follows:</P>
<UL>
	<LI><P CLASS="western" STYLE="margin-bottom: 0in">To provide a solid
	foundation for cross platform performance analysis tools</P>
	<LI><P STYLE="margin-bottom: 0in">To present a set of standard
	definitions for performance metrics on all platforms</P>
	<LI><P CLASS="western" STYLE="margin-bottom: 0in">To provide a
	standardize API among users, vendors, and academics</P>
	<LI><P CLASS="western" STYLE="margin-bottom: 0.19in">To be easy to
	use, well documented, and freely available</P>
</UL>
<H2 CLASS="western" STYLE="widows: 0; orphans: 0; page-break-before: always"><A NAME="ARCHITECTURE"></A><A NAME="_ARCHITECTURE"></A><A NAME="3.3.ARCHITECTURE|outline"></A>
ARCHITECTURE</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">T<IMG SRC="PAPI_USER_GUIDE_html_m4b91f0ff.gif" ALIGN=LEFT HSPACE=12><BR CLEAR=LEFT>he
<B>Figure </B>below shows the internal design of the PAPI
architecture. In this figure, we can see the two layers of the
architecture:</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The <B>Portable
Layer</B> consists of the API (<FONT COLOR="#0000ff"><U><A HREF="http://www.cs.utk.edu/~lparker/PAPICOUNTERINTERFACES.htm">low
level and high level</A></U></FONT>) and machine independent support
functions.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The <B>Machine
Specific Layer</B> defines and exports a machine independent
interface to machine dependent functions and data structures. These
functions are defined in the substrate layer, which uses kernel
extensions, operating system calls, or assembly language to access
the hardware performance counters. PAPI uses the most efficient and
flexible of the three, depending on what is available.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">PAPI strives to
provide a uniform environment across platforms. However, this is not
always possible. Where hardware support for features, such as
overflows and multiplexing is not supported, PAPI implements the
features in software where possible. Also, processors do not support
the same metrics, thus you can monitor different events depending on
the processor in use.  Therefore, the interface remains constant, but
how it is implemented can vary. Throughout this guide, implementation
decisions will be documented where it can make a difference to the
user, such as overhead costs, sampling, and etc.</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="4.INSTALLING PAPI	|outline"></A>
INSTALLING PAPI	</H1>
<P CLASS="western">On some of the systems that PAPI supports, you can
install PAPI right out of the box without any additional setup.
Others require drivers or patches to be installed first.</P>
<P CLASS="western"><B>Because installation instructions vary from
platform to platform, please find your particular Operating System
and hardware section in the /papi/INSTALL.txt file for current
information on exactly how to install PAPI for your configuration.</B></P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="C_AND_FORTRAN_CALLING_INTERFACES"></A><A NAME="5.C AND FORTRAN CALLING INTERFACES	|outline"></A>
C AND FORTRAN CALLING INTERFACES	</H1>
<P CLASS="western" STYLE="margin-bottom: 0.19in">PAPI is written in
C. The function calls in the C interface are defined in the header
file, <B>papi.h</B> and consist of the following form:</P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0.19in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>&lt;returned
data type&gt; PAPI_<I>function_name</I>(<I>arg1, arg2</I>,…)</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The function calls
in the Fortran interface are defined in the header file, <B>fpapi.h</B>
and consist of the following form:</P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0.19in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPIF_<I>function_name</I>(<I>arg1,
arg2</I>, …, check) </FONT></FONT>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">As you can see, the
C function calls have equivalent Fortran function calls (PAPI_&lt;call&gt;
becomes PAPIF_&lt;call&gt;). This is generally true for most function
calls, except for the functions that return C pointers to structures,
such as PAPI_get_opt and PAPI_get_executable_info, which are either
not implemented in the Fortran interface, or implemented with
different calling semantics. <B>In the function calls of the Fortran
interface, the return code of the corresponding C routine is returned
in the argument, <I>check</I>. </B>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">For most
architectures, the following relation holds between the pseudo-types
listed and Fortran variable types: 
</P>
<TABLE WIDTH=680 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=7 CELLSPACING=0>
	<COL WIDTH=148>
	<COL WIDTH=298>
	<COL WIDTH=190>
	<TR VALIGN=TOP>
		<TD WIDTH=148 HEIGHT=4 BGCOLOR="#cccccc">
			<P CLASS="western" ALIGN=CENTER><B>Pseudo-type</B></P>
		</TD>
		<TD WIDTH=298 BGCOLOR="#cccccc">
			<P CLASS="western" ALIGN=CENTER><B>Fortran type</B></P>
		</TD>
		<TD WIDTH=190 BGCOLOR="#cccccc">
			<P CLASS="western" ALIGN=CENTER><B>Description</B></P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=148 HEIGHT=5 BGCOLOR="#cccccc">
			<P CLASS="western">C_INT</P>
		</TD>
		<TD WIDTH=298 BGCOLOR="#cccccc">
			<P CLASS="western">INTEGER</P>
		</TD>
		<TD WIDTH=190 BGCOLOR="#cccccc">
			<P CLASS="western">Default Integer type</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=148 HEIGHT=5 BGCOLOR="#cccccc">
			<P CLASS="western">C_FLOAT</P>
		</TD>
		<TD WIDTH=298 BGCOLOR="#cccccc">
			<P CLASS="western">REAL</P>
		</TD>
		<TD WIDTH=190 BGCOLOR="#cccccc">
			<P CLASS="western">Default Real type</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=148 HEIGHT=5 BGCOLOR="#cccccc">
			<P CLASS="western">C_LONG_LONG</P>
		</TD>
		<TD WIDTH=298 BGCOLOR="#cccccc">
			<P CLASS="western">INTEGER*8</P>
		</TD>
		<TD WIDTH=190 BGCOLOR="#cccccc">
			<P CLASS="western">Extended size integer</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=148 HEIGHT=5 BGCOLOR="#cccccc">
			<P CLASS="western">C_STRING</P>
		</TD>
		<TD WIDTH=298 BGCOLOR="#cccccc">
			<P CLASS="western">CHARACTER*(PAPI_MAX_STR_LEN)</P>
		</TD>
		<TD WIDTH=190 BGCOLOR="#cccccc">
			<P CLASS="western">Fortran string</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=148 HEIGHT=23 BGCOLOR="#cccccc">
			<P CLASS="western">C_INT FUNCTION</P>
		</TD>
		<TD WIDTH=298 BGCOLOR="#cccccc">
			<P CLASS="western">EXTERNAL INTEGER FUNCTION</P>
		</TD>
		<TD WIDTH=190 BGCOLOR="#cccccc">
			<P CLASS="western">Fortran function returning integer result</P>
		</TD>
	</TR>
</TABLE>
<P CLASS="western" STYLE="margin-top: 0.19in; margin-bottom: 0.19in">Array
arguments must be of sufficient size to hold the input/output from/to
the subroutine for predictable behavior. The array length is
indicated either by the accompanying argument or by internal PAPI
definitions.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Subroutines
accepting <B>C_STRING</B> as an argument are on most implementations
capable of reading the character string length as provided by
Fortran. In these implementations, the string is truncated or space
padded as necessary. For other implementations, the length of the
character array is assumed to be of sufficient size. No character
string longer than <B>PAPI_MAX_STR_LEN</B> is returned by the PAPIF
interface. 
</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="EVENTS"></A><A NAME="6.EVENTS	|outline"></A>
EVENTS	</H1>
<H2 CLASS="western"><A NAME="WHAT_ARE_EVENTS"></A><A NAME="6.1.WHAT ARE EVENTS_|outline"></A>
WHAT ARE EVENTS?</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Events are
occurrences of specific signals related to a processor’s function.
Hardware performance counters exist as a small set of registers that
count events, such as cache misses and floating point operations
while the program executes on the processor.<FONT SIZE=2><FONT FACE="Times, serif">
</FONT></FONT>Monitoring these events facilitates correlation between
the structure of source/object code and the efficiency of the mapping
of that code to the underlying architecture. Each processor has a
number of events that are <I>native</I> to that architecture. PAPI
provides a software abstraction of these architecture-dependent
native events into a collection of <I>preset</I> events that are
accessible through the PAPI interface.</P>
<H2 CLASS="western"><A NAME="NATIVE_EVENTS"></A><A NAME="6.2.NATIVE EVENTS|outline"></A>
NATIVE EVENTS</H2>
<H3 CLASS="western"><A NAME="WHAT_ARE_NATIVE_EVENTS"></A><A NAME="6.2.1.WHAT ARE NATIVE EVENTS_|outline"></A>
WHAT ARE NATIVE EVENTS?</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Native events
comprise the set of all events that are countable by the CPU. There
are generally far more native events available than can be mapped
onto PAPI preset events. Even if no preset event is available that
exposes a given native event, native events can still be accessed
directly. To use native events effectively you should be very
familiar with the particular platform in use. PAPI provides access to
native events on all supported platforms through the low-level
interface. Native events use the same interface as used when setting
up a preset event, but since a PAPI preset event definition is not
available for native events, a native event name must often be
translated into an event code before it can be used.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>Native event
codes and names are platform dependent, so native codes for one
platform are not likely to work for any other platform.</B> To
determine the native events for your platform, see the native event
lists for the various platforms in the <FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/papi/links">processor
architecture manual</A></U></FONT>. Every attempt is made to keep
native event names used by PAPI as similar as possible to those used
in the vendor documentation. This is not always possible. The utility
code <FONT FACE="Courier New, monospace">util/papi_native_avail</FONT>
provides insight into the names of the native events for a specific
platform.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Native events are
specified as arguments to the low-level function, PAPI_add_event in a
manner similar to adding PAPI preset events. In the following code
example, a native event name is converted to an event code and added
to an eventset by using PAPI_add_event:</P>
<P STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include&lt;stdio.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
retval, EventSet = PAPI_NULL;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>unsigned
int native = 0x0;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_event_info_t
info;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Initialize the library */</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= PAPI_library_init(PAPI_VER_CURRENT);</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(retval != PAPI_VER_CURRENT) {</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(“PAPI
library init error!\n”);</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_create_eventset(&amp;EventSet) != PAPI_OK) </FONT></FONT>
</P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in">  
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in">  
</P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Find the first available native event */</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>native
= NATIVE_MASK | 0;</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_get_event_info(native, &amp;info) != PAPI_OK) {</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_enum_event(&amp;native, 0) != PAPI_OK) </FONT></FONT>
</P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in">     
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Add it to the eventset */</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_add_event(EventSet, native) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in">  
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P LANG="" STYLE="margin-left: 0.25in; margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">For more code
examples using native events, see <FONT FACE="Courier New, monospace">ctests/native.c</FONT>
and <FONT FACE="Courier New, monospace">util/native_avail.c</FONT> in
the papi source distribution. 
</P>
<H2 CLASS="western"><A NAME="PRESET_EVENTS"></A><A NAME="6.3.PRESET EVENTS|outline"></A>
PRESET EVENTS</H2>
<H3 CLASS="western"><A NAME="WHAT_ARE_PRESET_EVENTS"></A><A NAME="6.3.1.WHAT ARE PRESET EVENTS_|outline"></A>
WHAT ARE PRESET EVENTS?</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Preset events, also
known as predefined events, are a common set of events deemed
relevant and useful for application performance tuning. These events
are typically found in many CPUs that provide performance counters
and give access to the memory hierarchy, cache coherence protocol
events, cycle and instruction counts, functional unit, and pipeline
status. Furthermore, preset events are mappings from symbolic names
(PAPI preset name) to machine specific definitions (native countable
events) for a particular hardware resource. For example, Total Cycles
(in user mode) is PAPI_TOT_CYC. Also, PAPI supports presets that may
be derived from the underlying hardware metrics. For example, Total
L1 Cache Misses (PAPI_L1_TCM) might be the sum of L1 Data Misses and
L1 Instruction Misses on a given platform. A preset can be either
directly available as a single counter, derived using a combination
of counters, or unavailable on any particular platform. 
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The PAPI library
names approximately 100 preset events, which are defined in the
header file, <B>papiStdEventDefs.h</B>. For a given platform, a
subset of these preset events can be counted though either a simple
high-level programming interface or a more complete C or Fortran
low-level interface. For a representative list of all the preset
events on some supported platforms, visit the PAPI web page:
<FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/projects/papi/presets.html">http://icl.cs.utk.edu/projects/papi/presets.html</A></U></FONT>.
Note that processors and software are revised over time, and this
list may not be up to date. To determine exactly which preset events
are available on a specific platform, run <FONT FACE="Courier New, monospace">util/papi_avail.c</FONT>
in the papi source distribution. 
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><I>The exact
semantics of an event counter are platform dependent</I>. PAPI preset
names are mapped onto available events so as to map as many countable
events as possible on different platforms. Due to hardware
implementation differences, it is not necessarily feasible to
directly compare the counts of a particular PAPI preset event
obtained on different hardware platforms. 
</P>
<H2 CLASS="western"><A NAME="PRESET_QUERY"></A><A NAME="6.4.EVENT QUERY|outline"></A>
EVENT QUERY</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The following
low-level functions can be called to query about the existence of a
preset or native event (in other words, if the hardware supports that
certain event), and to get details about that event:</P>
<P CLASS="western"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT SIZE=3>PAPI_query_event(<I>EventCode</I>)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_get_event_info(<I>EventCode</I>,
&amp;<I>info</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT SIZE=3>PAPI_enum_event(&amp;<I>EventCode</I>,
<I>modifier</I>)</FONT></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_query_event(<I>EventCode</I>,
<I>check</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_get_event_info(<I>EventCode</I>,
<I>symbol</I>, <I>longDescr</I>, <I>shortDescr</I>, <I>count</I>,
<I>note</I>, <I>flags</I>, <I>check</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_enum_event(&amp;<I>EventCode</I>,
<I>modifier</I>, <I>check</I>)</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H4 CLASS="western">ARGUMENTS</H4>
<P STYLE="margin-left: 0.25in; text-indent: -0.25in; margin-bottom: 0.19in">
<I><FONT FACE="Courier New, monospace">EventCode</FONT></I> -- a
defined event, such as <FONT FACE="Courier New, monospace">PAPI_TOT_INS</FONT>.
</P>
<P STYLE="margin-left: 0.25in; text-indent: -0.25in; margin-bottom: 0.19in">
<I><FONT FACE="Courier New, monospace">symbol</FONT></I> -- the event
symbol, or name, such as the preset name, <FONT FACE="Courier New, monospace">PAPI_BR_CN</FONT>.</P>
<P STYLE="margin-left: 0.25in; text-indent: -0.25in; margin-bottom: 0.19in">
<I><FONT FACE="Courier New, monospace">longDescr</FONT></I> -- a
descriptive string for the event of length less than
<B><FONT FACE="Courier New, monospace">PAPI_MAX_STR_LEN</FONT></B>. 
</P>
<P STYLE="margin-left: 0.25in; text-indent: -0.25in; margin-bottom: 0.19in">
<I><FONT FACE="Courier New, monospace">shortDescr</FONT></I> -- a
short descriptive string for the event of length less than 18
characters. 
</P>
<P STYLE="margin-left: 0.25in; text-indent: -0.25in; margin-bottom: 0.19in">
<I><FONT FACE="Courier New, monospace">count</FONT></I> -- zero if
the event CANNOT be counted. 
</P>
<P STYLE="margin-left: 0.25in; text-indent: -0.25in; margin-bottom: 0.19in">
<I><FONT FACE="Courier New, monospace">note</FONT></I> -- additional
text information about an event (if available). 
</P>
<P STYLE="margin-left: 0.25in; text-indent: -0.25in; margin-bottom: 0.19in">
<FONT FACE="Courier New, monospace">flags</FONT> -- provides
additional information about an event, e.g., <B><FONT FACE="Courier New, monospace">PAPI_DERIVED</FONT></B>
for an event derived from 2 or more other events. 
</P>
<P STYLE="margin-left: 0.25in; text-indent: -0.25in; margin-bottom: 0.19in">
<I><FONT FACE="Courier New, monospace">modifier</FONT></I> --
modifies the search criteria; for preset events, returns all events
or only available events; for native events, the definition is
platform dependent.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_query_event</FONT>
asks the PAPI library if the preset or native event can be counted on
this architecture. If the event CAN be counted, the function returns
PAPI_OK. If the event CANNOT be counted, the function returns an
error code. 
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_get_event_info</FONT>
asks the PAPI library for a copy of an event descriptor. This
descriptor can then be used to investigate the details about the
event. In Fortran, the individual fields in the descriptor are
returned as parameters.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_enum_event</FONT>
asks the PAPI library to return an event code for the next sequential
event based on the current event code and the modifier. This function
can be used to enumerate all preset or native events on any platform.
See <FONT FACE="Courier New, monospace">util/papi_avail.c</FONT> or
<FONT FACE="Courier New, monospace">util/papi_native_avail.c</FONT>
for details.</P>
<H4 CLASS="western">EXAMPLE:</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;stdio.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
EventSet = PAPI_NULL;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>unsigned
int native = 0x0;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
retval, i;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_preset_info_t
info;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_preset_info_t
*infostructs;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Initialize the library */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= PAPI_library_init(PAPI_VER_CURRENT);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(retval != PAPI_VER_CURRENT) {</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>	fprintf(stderr,&quot;PAPI
library init error!\n&quot;);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>	exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Check to see if the preset, PAPI_TOT_INS, exists */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_query_event (PAPI_TOT_INS) != PAPI_OK) {</FONT></FONT></P>
<P STYLE="margin-left: 0.5in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf
(stderr,&quot;No instruction counter? How lame.\n&quot;);</FONT></FONT></P>
<P STYLE="margin-left: 0.5in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Get details about the preset, PAPI_TOT_INS */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_get_event_info(PAPI_TOT_INS,&amp;info) != PAPI_OK) {</FONT></FONT></P>
<P STYLE="margin-left: 0.5in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf
(stderr,&quot;No instruction counter? How lame.\n&quot;);</FONT></FONT></P>
<P STYLE="margin-left: 0.5in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(info.count&gt;0)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>	printf
(&quot;This event is available on this hardware.\n&quot;);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(info.flags &amp; PAPI_DERIVED)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>	printf
(&quot;This event is a derived event on this hardware.\n&quot;);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Count the number of available preset events between </FONT></FONT>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_TOT_INS
and the end of the preset list */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= 0;</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>i
= PAPI_TOT_INS;</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>while
(PAPI_enum_event(&amp;i, TRUE) == PAPI_OK) {</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>retval++;</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H4 CLASS="western">OUTPUT (if <FONT FACE="Courier New, monospace">PAPI_TOT_INS</FONT>
is available on your system):</H4>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>This
event is available on this hardware.</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In the above code
example, <FONT FACE="Courier New, monospace">PAPI_query_event</FONT>
is used to see if a preset (<FONT FACE="Courier New, monospace">PAPI_TOT_INS</FONT>)
exists, <FONT FACE="Courier New, monospace">PAPI_get_event_info</FONT>
is used to query details about the event, and <FONT FACE="Courier New, monospace">PAPI_enum_event</FONT>
is used to count the number of events in the preset list after this
preset.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">On success, all
three of these functions return <FONT FACE="Courier New, monospace">PAPI_OK</FONT>,
and on error, a non-zero error code is returned.</P>
<H2 CLASS="western" STYLE="page-break-before: always"><A NAME="PRESET_TRANSLATION"></A><A NAME="6.5.EVENT TRANSLATION|outline"></A>
EVENT TRANSLATION</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">A preset or native
event can be referenced by name or by event code. Most PAPI functions
require an event code, while most user input and output is in terms
of names. Two low-level functions are provided to translate between
these formats: 
</P>
<P CLASS="western"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_event_name_to_code(<I>EventName</I>,
<I>EventCode</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_event_code_to_name(<I>EventCode</I>,
<I>EventName</I>)</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_event_name_to_code(<I>EventName</I>,
<I>EventCode</I>, <I>check</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_event_code_to_name(<I>EventCode</I>,
<I>EventName</I>, <I>check</I>)</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H4 CLASS="western">ARGUMENTS</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>EventCode</I>
<FONT FACE="Verdana, sans-serif">-- a preset or native event of
integer type, such as </FONT>PAPI_TOT_INS<FONT FACE="Times New Roman, serif">.</FONT>
</FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>EventName</I><FONT FACE="Verdana, sans-serif">
-- the event name string, such as the preset name,</FONT><FONT FACE="Times New Roman, serif">
</FONT>“PAPI_BR_CN”<FONT FACE="Times New Roman, serif">.</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Note that the preset
does not actually have to be available on a given platform to call
these functions. Native event names are platform specific and where
feasible match those given in the vendor documentation.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_event_name_to_code</FONT>
is used to translate an ASCII PAPI preset or native event name into
an integer PAPI event code. 
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_event_code_to_name</FONT>
is used to translate an integer PAPI event code into an ASCII PAPI
preset or native event name.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Using
<FONT FACE="Courier New, monospace">PAPI_event_code_to_name</FONT> in
conjunction with <FONT FACE="Courier New, monospace">PAPI_enum_event</FONT>
is a good way to explore the names of native events on a specific
platform, as shown in the following code example:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;stdio.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
EventCode, retval;</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>char
EventCodeStr[PAPI_MAX_STR_LEN];</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>	</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Initialize the library */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= PAPI_library_init(PAPI_VER_CURRENT);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
 (retval != PAPI_VER_CURRENT) {</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stderr,
“PAPI library init error!\n”);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);
</FONT></FONT>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"> <FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>EventCode
= 0 | NATIVE_MASK;</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>do
{</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Translate the integer code to a string */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_event_code_to_name(EventCode, EventCodeStr) == PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">      <FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Print all the native events for this platform */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">     
<FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;Name:
%s\nCode: %x\n&quot;, EventCodeStr, EventCode);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}
while (PAPI_enum_event(&amp;EventCode, 0) == PAPI_OK);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P LANG="" STYLE="margin-left: 0.25in; margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western">OUTPUT:</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Name:
DATA_MEM_REFS</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Code:
40000000</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Name:
DCU_LINES_IN</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Code:
40000001</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Name:
DCU_M_LINES_IN</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Code:
40000002</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Name:
SEG_REG_RENAMES_TOT</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Code:
40000078</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Name:
RET_SEG_RENAMES</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Code:
40000079</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The output will vary
depending on the platform. This was generated on an Intel Pentium III
processor. 
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">On success, all the
functions return PAPI_OK and on error, a non-zero error code is
returned.</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="PAPI_COUNTER_INTERFACES"></A><A NAME="7.PAPI’S COUNTER INTERFACES	|outline"></A>
PAPI’S COUNTER INTERFACES	</H1>
<H2 CLASS="western"><A NAME="HIGH_LEVEL_API"></A><A NAME="7.1.HIGH-LEVEL API|outline"></A>
HIGH-LEVEL API</H2>
<H3 CLASS="western"><A NAME="WHAT_IS_HIGH_LEVEL_API"></A><A NAME="7.1.1.WHAT IS THE HIGH-LEVEL API_|outline"></A>
WHAT IS THE HIGH-LEVEL API?</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The high-level API
(<B>A</B>pplication <B>P</B>rogramming <B>I</B>nterface) provides the
ability to start, stop, and read the counters for a specified list of
events. It is meant for programmers wanting simple event measurements
using only PAPI preset events. Some of the benefits of using the
high-level API rather than the low-level API are that it is easier to
use and requires less setup (additional calls). This ease of use
comes with somewhat higher overhead and loss of flexibility.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">It should also be
noted that the high-level API can be used in conjunction with the
low-level API and in fact does call the low-level API. However, the
high-level API by itself is only able to access those events
countable simultaneously by the underlying hardware. 
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">There are eight
functions that represent the high-level API that allow the user to
access and count specific hardware events. <I>Note that these
functions can be accessed from both C and Fortran. </I>For a code
example of using the high-level interface, see <FONT COLOR="#0000ff"><U><A HREF="#HIGH_LEVEL_EXAMPLE">Simple
Code Examples:  High Level API</A></U></FONT> or <FONT FACE="Courier New, monospace">ctests/high-level.c</FONT>
in the PAPI source distribution.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>For full details
on the calling semantics of these functions, please refer to the PAPI
Programmer’s Reference.</B></P>
<H3 CLASS="western"><A NAME="INITIALIZATION_HIGH_LEVEL"></A><A NAME="7.1.2.INITIALIZING THE HIGH-LEVEL API|outline"></A>
INITIALIZING THE HIGH-LEVEL API</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The PAPI library is
initialized implicitly by several high-level API calls. In addition
to the three rate calls discussed later, either of the following two
functions also implicitly initializes the library: 
</P>
<P STYLE="margin-bottom: 0.19in; font-style: normal"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_num_counters()</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>PAPI_start_counters(*events,
array_length)	</I></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P STYLE="margin-bottom: 0.19in; font-style: normal"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_num_counters(check)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_start_counters<I>(*events</I>,
<I>array_length</I>, check)</FONT></P>
<P STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H4 CLASS="western">ARGUMENTS</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>*events</I>
<FONT FACE="Times New Roman, serif">-- an array of codes for events
such as PAPI_INT_INS or a native event code.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>array_length</I>
<FONT FACE="Times New Roman, serif">-- the number of items in the
<I>events</I> array.</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_num_counters</FONT>
returns the optimal length of the <I><FONT FACE="Courier New, monospace">values</FONT></I>
array for high-level functions. This value corresponds to the number
of hardware counters supported by the current substrate.
<FONT FACE="Courier New, monospace">PAPI_num_counters</FONT>
initializes the PAPI library using <FONT FACE="Courier New, monospace">PAPI_library_init</FONT>
if necessary.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_start_counters</FONT>
initializes the PAPI library (if necessary) and starts counting the
events named in the <I><FONT FACE="Courier New, monospace">events</FONT></I>
array. This function implicitly stops and initializes any counters
running as a result of a previous call to <FONT FACE="Courier New, monospace">PAPI_start_counters</FONT>.
It is the user’s responsibility to choose events that can be
counted simultaneously by reading the vendor’s documentation. The
size of <I>array_length</I> should be no larger than the value
returned by <FONT FACE="Courier New, monospace">PAPI_num_counters</FONT>.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In the following
code example, <FONT FACE="Courier New, monospace">PAPI_num_counters</FONT>
is used to initialize the library and to get the number of hardware
counters available on the system. Also, <FONT FACE="Courier New, monospace">PAPI_start_counters</FONT>
is used to start counting events:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in">&nbsp;</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
Events[2] = { PAPI_TOT_CYC, PAPI_TOT_INS };</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
num_hwcntrs = 0;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Initialize the PAPI library and get the number of counters available
*/</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
((num_hwcntrs = PAPI_num_counters()) &lt;= PAPI_OK)  </FONT></FONT></FONT></FONT>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   
<FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;This
system has %d available counters.&quot;, num_hwcntrs);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(num_hwcntrs &gt; 2)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>num_hwcntrs
= 2;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">     <FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Start counting events */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">     <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_start_counters(Events, num_hwcntrs) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">         <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H4 CLASS="western">POSSIBLE OUTPUT (varies on different systems):</H4>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">This
system has 4 available counters.</FONT></P>
<P STYLE="margin-bottom: 0.19in; font-style: normal"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">On success,
<FONT FACE="Courier New, monospace">PAPI_num_counters</FONT> returns
the number of hardware counters available on the system and on error,
a non-zero error code is returned. 
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B><I>Optionally</I>,
the PAPI library can be initialized explicitly by using
</B><FONT COLOR="#0000ff"><U><A HREF="#_INITIALIZATION_OF_A"><B><FONT FACE="Courier New, monospace">PAPI_library_init</FONT></B></A></U></FONT><B>.
This can be useful if you wish to call PAPI low-level API functions
before using the high-level functions.</B></P>
<H3 CLASS="western"><A NAME="7.1.3.EXECUTION RATE CALLS	|outline"></A>
EXECUTION RATE CALLS	</H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">Three
PAPI high-level functions are available to measure floating point or
total instruction rates. These three calls are shown below:</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT SIZE=3>PAPI_flips(*<I>real_time,
*proc_time, *flpins, *mflips</I>)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT SIZE=3>PAPI_flops(*<I>real_time,
*proc_time, *flpins, *mflops</I>)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT SIZE=3>PAPI_ipc(*<I>real_time,
*proc_time, *ins, *ipc</I>)</FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_flips(<I>real_time,
proc_time, flpins, mflips</I>, check)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_flops(<I>real_time,
proc_time, flpins, mflops</I>, check)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_ipc(<I>real_time,
proc_time, ins, ipc</I>, check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western" ALIGN=LEFT>ARGUMENTS</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>*real_time</I><FONT FACE="Verdana, sans-serif">
-- the total real (wallclock) time since the first rate call.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>*proc_time</I><FONT FACE="Verdana, sans-serif">
-- the total process time since the first rate call.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>*flpins</I><FONT FACE="Verdana, sans-serif">
-- the total floating point instructions since the first rate call.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>*mflips,
*mflops</I><FONT FACE="Verdana, sans-serif"> – Millions of floating
point operations or instructions per second achieved since the latest
rate call.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>*ins</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- the total instructions
executed since the first PAPI_ipc call.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>*ipc</I>
<FONT FACE="Verdana, sans-serif">– instructions per cycle achieved
since the latest PAPI_ipc call.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The first execution
rate call initializes the PAPI library if needed, sets up the
counters to monitor either <FONT FACE="Courier New, monospace">PAPI_FP_INS</FONT>,
<FONT FACE="Courier New, monospace">PAPI_FP_OPS</FONT> or
<FONT FACE="Courier New, monospace">PAPI_TOT_INS</FONT> (depending on
the call), and <FONT FACE="Courier New, monospace">PAPI_TOT_CYC</FONT>
events, and starts the counters. Subsequent calls to the same rate
function will read the counters and return total real time, total
process time, total instructions or operations, and the appropriate
rate of execution since the last call. A call to <FONT FACE="Courier New, monospace">PAPI_stop_counters</FONT>
will reinitialize all values to 0. Sequential calls to different
execution rate functions will return an error.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><I>Note
that on many platforms there may be subtle differences between
floating point instructions and operations<B>.</B></I> Instructions
are typically those execution elements most directly measured by the
hardware counters. They may include floating point load and store
instructions, and may count instructions such as FMA as one, even
though two floating point operations have occurred. Consult the
hardware documentation for your system for more details. Operations
represent a derived value where an attempt is made, when possible, to
more closely map to the theoretical definition of a floating point
event.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">On
success, the rate calls return <FONT FACE="Courier New, monospace">PAPI_OK</FONT>
and on error, a non-zero error code is returned.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">For a
code example, see <FONT FACE="Courier New, monospace">ctest/flops.c</FONT>
or <FONT FACE="Courier New, monospace">ctest/ipc.c</FONT> in the papi
source distribution.</P>
<H3 CLASS="western"><A NAME="READING_ADDING_STOPPING_COUNTERS"></A><A NAME="7.1.4.READING, ACCUMULATING, AND STOPPING COUNTERS|outline"></A>
READING, ACCUMULATING, AND STOPPING COUNTERS</H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">Counters
can be read, accumulated, and stopped by calling the following
high-level functions, respectively:</P>
<P ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in; font-style: normal"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_read_counters(*<I>values,
array_length</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_accum_counters(*<I>values,
array_length</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_stop_counters(*<I>values,
array_length</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in; font-style: normal"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_read_counters(<I>*</I>values,
array_length<I>, </I>check)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_accum_counters(*<I>values</I>,
<I>array_length</I>, check)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_stop_counters(*<I>values</I>,
<I>array_length</I>, check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western" ALIGN=LEFT>ARGUMENTS</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>*values</I>
<FONT FACE="Verdana, sans-serif">-- an array where to put the counter
values. </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>array_length</I>
<FONT FACE="Verdana, sans-serif">-- the number of items in the
*values array. </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_read_counters,
PAPI_accum_counters</FONT> and <FONT FACE="Courier New, monospace">PAPI_stop_counters</FONT>
all capture the values of the currently running counters into the
array, <I><FONT FACE="Courier New, monospace">values</FONT></I>. Each
of these functions behaves somewhat differently.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_read_counters</FONT>
copies the current counts into the elements of the <I><FONT FACE="Courier New, monospace">values</FONT></I>
array, resets the counters to zero, and leaves the counters running.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_accum_counters</FONT>
adds the current counts into the elements of the <I><FONT FACE="Courier New, monospace">values</FONT></I>
array and resets the counters to zero, leaving the counters running.
Care should be exercised not to mix calls to <FONT FACE="Courier New, monospace">PAPI_accum_counters</FONT>
with calls to the execution rate functions. Such intermixing is
likely to produce unexpected results.  
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_stop_counters</FONT>
stops the counters and copies the current counts into the elements of
the <I><FONT FACE="Courier New, monospace">values</FONT></I> array.
This call can also be used to reset the rate functions if used with a
NULL pointer to the <I><FONT FACE="Courier New, monospace">values</FONT></I>
array.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In the following
code example, <FONT FACE="Courier New, monospace">PAPI_read_counters</FONT>
and <FONT FACE="Courier New, monospace">PAPI_stop_counters</FONT> are
used to copy and stop event counters in an array, respectively:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#define
NUM_EVENTS 2</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
Events[NUM_EVENTS] = {PAPI_TOT_INS, PAPI_TOT_CYC};</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>long_long
values[NUM_EVENTS];</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Start counting events */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_start_counters(Events, NUM_EVENTS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Do some computation here*/</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Read the counters */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_read_counters(values, NUM_EVENTS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Do some computation here */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Stop counting events */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_stop_counters(values, NUM_EVENTS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">On
success, all of these functions return <FONT FACE="Courier New, monospace">PAPI_OK</FONT>
and on error, a non-zero error code is returned.</P>
<H2 CLASS="western"><A NAME="LOW_LEVEL_API"></A><A NAME="_MFLOPS/S,_REAL_TIME,"></A><A NAME="7.2.LOW-LEVEL API|outline"></A>
LOW-LEVEL API</H2>
<H3 CLASS="western"><A NAME="WHAT_IS_LOW_LEVEL_API"></A><A NAME="7.2.1.WHAT IS THE LOW-LEVEL API_|outline"></A>
WHAT IS THE LOW-LEVEL API?</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The low-level API
(<B>A</B>pplication <B>P</B>rogramming <B>I</B>nterface) manages
hardware events in user-defined groups called <FONT COLOR="#0000ff"><U><A HREF="#EVENT_SETS">Event
Sets</A></U></FONT>. It is meant for experienced application
programmers and tool developers wanting fine-grained measurement and
control of the PAPI interface. <I>Unlike the high-level interface, it
allows both PAPI preset and native events. </I>Other features of the
low-level API are the ability to obtain information about the
executable and the hardware as well as to set options for
multiplexing and overflow handling. Some of the benefits of using the
low-level API rather than the high-level API are that it increases
efficiency and functionality.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">It should also be
noted that the low-level interface could be used in conjunction with
the high-level interface, as long as attention is paid to insure that
the PAPI library is initialized prior to the first low-level PAPI
call. 
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The low-level API is
only as powerful as the substrate upon which it is built. <I>Thus,
some features may not be available on every platform</I>. The
converse may also be true, that more advanced features may be
available on every platform and defined in the header file.
Therefore, the user is encouraged to read the documentation for each
platform carefully. <I>There are approximately 50 functions that
represent the low-level API.</I> For a code example of using the
low-level interface, see <FONT COLOR="#0000ff"><U><A HREF="#LOW_LEVEL_EXAMPLE">Simple
Code Examples: Low-Level API</A></U></FONT> or <FONT FACE="Courier New, monospace">ctests/low_level.c</FONT>
in the PAPI source distribution.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>Note that most
functions are implemented in both C and Fortran, but some are
implemented in only one of these two languages. For full details on
the calling semantics of these functions, please refer to the PAPI
Programmer’s Reference. </B>
</P>
<H3 CLASS="western"><A NAME="INITIALIZATION_LOW_LEVEL"></A><A NAME="_INITIALIZATION_OF_A"></A><A NAME="7.2.2.INITIALIZATION OF THE LOW-LEVEL API|outline"></A>
INITIALIZATION OF THE LOW-LEVEL API</H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">The
PAPI library must be initialized before it can be used. It can be
initialized explicitly by calling the following low-level function:</P>
<P ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in; font-style: normal"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_library_init(<I>version</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in; font-style: normal"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_library_init(check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western" ALIGN=LEFT>ARGUMENT</H4>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><I><FONT FACE="Courier New, monospace">version</FONT></I>
--  upon initialization, PAPI checks the argument against the
internal value of <B><FONT FACE="Courier New, monospace">PAPI_VER_CURRENT</FONT></B>
when the library was compiled. This guards against portability
problems when updating the PAPI shared libraries on your system.</P>
<P ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in; font-style: normal"><B>Note
that this function must be called before calling any other low-level
PAPI function.</B></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">On
success, this function returns <FONT FACE="Courier New, monospace">PAPI_VER_CURRENT</FONT>.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">On
error, a <I>positive</I> return code other than <FONT FACE="Courier New, monospace">PAPI_VER_CURRENT</FONT>
indicates a library version mismatch and a <I>negative</I> return
code indicates an initialization error. 
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">Beginning
with PAPI 3.0, there are a number of options for examining the
current version number of PAPI:</P>
<UL>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_VERSION</FONT>
	produces an integer containing the complete current version
	including <FONT FACE="Courier New, monospace">MAJOR</FONT>, <FONT FACE="Courier New, monospace">MINOR</FONT>,
	and <FONT FACE="Courier New, monospace">REVISION</FONT> components.
	Typically the <FONT FACE="Courier New, monospace">REVISION</FONT>
	component changes with bug fixes or minor enhancements, the <FONT FACE="Courier New, monospace">MINOR</FONT>
	component changes with feature additions or API changes, and the
	<FONT FACE="Courier New, monospace">MAJOR</FONT> component changes
	with significant API structural changes.</P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_VER_CURRENT</FONT>
	contains the <FONT FACE="Courier New, monospace">MAJOR</FONT> and
	<FONT FACE="Courier New, monospace">MINOR</FONT> components and is
	useful for determining library compatibility changes.</P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_VERSION_MAJOR</FONT>,</P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_VERSION_MINOR</FONT>,</P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_VERSION_REVISION</FONT>
	are macros that extract specified component from the version number.</P>
</UL>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">The
following is a code example of using <FONT FACE="Courier New, monospace">PAPI_library_init</FONT>
to initialize the PAPI library:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;stdio.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
retval;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Initialize the PAPI library */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= PAPI_library_init(PAPI_VER_CURRENT);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(retval != PAPI_VER_CURRENT &amp;&amp; retval &gt; 0) {</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"> 
<FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stderr,&quot;PAPI
library version mismatch!\n&quot;);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(retval &lt; 0) {</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stderr,
“Initialization error!\n”);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stdout,
“PAPI Version Number\n”);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stdout,
“MAJOR:    %d\n”, PAPI_MAJOR(retval));</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stdout,
“MINOR:    %d\n”, PAPI_MINOR(retval));</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stdout,
“REVISION: %d\n”, PAPI_REVISION(retval));</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H4 CLASS="western">OUTPUT FOR PAPI VERSION 3.5.0</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI
Version Number</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>MAJOR:
   3</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>MINOR:
   5</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>REVISION:
0</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H2 CLASS="western"><A NAME="EVENT_SETS"></A><A NAME="7.3.EVENT SETS|outline"></A>
EVENT SETS</H2>
<H3 CLASS="western"><A NAME="WHAT_ARE_EVENT_SETS"></A><A NAME="7.3.1.WHAT ARE EVENT SETS_|outline"></A>
WHAT ARE EVENT SETS?</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Event Sets are
user-defined groups of hardware events (preset or native), which are
used in conjunction with one another to provide meaningful
information. The user specifies the events to be added to an Event
Set, and other attributes, such as:  the counting domain (user or
kernel), whether or not the events in the Event Set are to be
multiplexed, and whether the Event Set is to be used for overflow or
profiling. Other settings for the Event Set are maintained by PAPI,
such as: what low-level hardware registers to use, the most recently
read counter values, and the state of the Event Set (running/not
running). Event Sets provide an effective abstraction for the
organization of information associated with counting hardware events.
The PAPI library manages the memory for Event Sets with a user
interface through integer handles to simplify calling conventions.
The user is free to allocate and use any number of them provided the
substrate can provide the required resources. Only one Event Set can
be in active use at any time in a given thread or process.</P>
<H3 CLASS="western"><A NAME="CREATING_EVENT_SETS"></A><A NAME="7.3.2.CREATING AN EVENT SET|outline"></A>
CREATING AN EVENT SET</H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">An
event set can be created by calling the following the low-level
function:</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_create_eventset
(<I>*EventSet</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in; font-style: normal"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_create_eventset(<I>EventSet,
</I>check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western" ALIGN=LEFT>ARGUMENT</H4>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">EventSet</FONT>
-- Address of an integer location to store the new EventSet handle.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">Once
it has been created, the user may add hardware events to the <I>EventSet</I>
by calling PAPI_add_event or PAPI_add_events.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">On
success, this function returns PAPI_OK. On error, a non-zero error
code is returned. 
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">For a
code example using this function, see the next section. 
</P>
<H3 CLASS="western"><A NAME="ADDING_EVENT_SETS"></A><A NAME="7.3.3.ADDING EVENTS TO AN EVENT SET|outline"></A>
ADDING EVENTS TO AN EVENT SET</H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">Hardware
events can be added to an event set by calling the following the
low-level functions:</P>
<P ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in; font-style: normal"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_add_event(<I>EventSet,
EventCode</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_add_events(<I>EventSet,
*EventCode, number</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in; font-style: normal"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_add_event(<I>EventSet,
EventCode, </I>check)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_add_events(<I>EventSet,
EventCode, number, </I>check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western" ALIGN=LEFT>ARGUMENTS</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>EventSet</I>
<FONT FACE="Verdana, sans-serif">-- an integer handle for a PAPI
Event Set as created by </FONT>PAPI_create_eventset<FONT FACE="Verdana, sans-serif">.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>EventCode</I>
<FONT FACE="Verdana, sans-serif">-- a defined event such as
</FONT>PAPI_TOT_INS<FONT FACE="Times New Roman, serif">.</FONT> </FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>*EventCode</I>
<FONT FACE="Verdana, sans-serif">– address of an array of defined
events.</FONT> </FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>number</I>
<FONT FACE="Verdana, sans-serif">-- an integer indicating the number
of events in the array </FONT><I><FONT FACE="Times New Roman, serif">*</FONT>EventCode</I><FONT FACE="Times New Roman, serif">.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_add_event</FONT>
adds a single hardware event to a PAPI event set.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_add_events</FONT>
does the same as <FONT FACE="Courier New, monospace">PAPI_add_event</FONT>,
but for an array of hardware event codes.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">In the
following code example, the preset event, <FONT FACE="Courier New, monospace">PAPI_TOT_INS</FONT>
is added to an event set:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;stdio.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
EventSet = PAPI_NULL;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
retval;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Initialize the PAPI library */</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= PAPI_library_init(PAPI_VER_CURRENT);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(retval != PAPI_VER_CURRENT) {</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stderr,
&quot;PAPI library init error!\n&quot;);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);
</FONT></FONT></FONT></FONT>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Create an EventSet */&nbsp;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_create_eventset(&amp;EventSet) != PAPI_OK)</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Add Total Instructions Executed to our EventSet */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_add_event(EventSet, PAPI_TOT_INS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">On
success, both of these functions return <FONT FACE="Courier New, monospace">PAPI_OK</FONT>
and on error, a non-zero error code is returned.</P>
<H3 CLASS="western"><A NAME="STARTING_EVENT_SETS"></A><A NAME="7.3.4.STARTING, READING, ADDING, AND STOPPING EVENTS IN AN EVENT SET|outline"></A>
STARTING, READING, ADDING, AND STOPPING EVENTS IN AN EVENT SET</H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">Hardware
events in an event set can be started, read, added, and stopped by
calling the following low-level functions, respectively:</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_start(<I>EventSet</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_read(<I>EventSet,
*values</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_accum(<I>EventSet</I>,
<I>*values</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_stop(<I>EventSet,
*values</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in; font-style: normal"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_start(<I>EventSet,</I>
check)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_read(<I>EventSet,
values,</I> check)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_accum(<I>EventSet</I>,
<I>values</I>, check)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_stop(<I>EventSet,
values,</I> check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western" ALIGN=LEFT>ARGUMENTS</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>EventSet</I>
<FONT FACE="Verdana, sans-serif">-- an integer handle for a PAPI
Event Set as created by </FONT>PAPI_create_eventset<FONT FACE="Verdana, sans-serif">.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>*values</I>
<FONT FACE="Verdana, sans-serif">-- an array to hold the counter
values of the counting events.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_start</FONT>
starts the counting events in a previously defined event set.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_read</FONT>
reads (copies) the counters of the indicated event set into the
array, <I><FONT FACE="Courier New, monospace">values</FONT></I>. The
counters are left counting after the read without resetting.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_accum</FONT>
adds the counters of the indicated event set into the array, <I><FONT FACE="Courier New, monospace">values</FONT></I>.
The counters are reset and left counting after the call of this
function.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_stop</FONT>
stops the counting events in a previously defined event set and
returns the current events.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The following is a
code example of using <FONT FACE="Courier New, monospace">PAPI_start</FONT>
to start the counting of events in an event set, <FONT FACE="Courier New, monospace">PAPI_read</FONT>
to read the counters of the same event set into the array <I><FONT FACE="Courier New, monospace">values</FONT></I>,
and <FONT FACE="Courier New, monospace">PAPI_stop</FONT> to stop the
counting of events in the event set:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;stdio.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
retval, EventSet = PAPI_NULL;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>long_long
values[1];</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Initialize the PAPI library */</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= PAPI_library_init(PAPI_VER_CURRENT);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(retval != PAPI_VER_CURRENT) {</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stderr,
&quot;PAPI library init error!\n&quot;);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Create the Event Set */</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_create_eventset(&amp;EventSet) != PAPI_OK)</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   
<FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Add Total Instructions Executed to our EventSet */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_add_event(EventSet, PAPI_TOT_INS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Start counting */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_start(EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Do some computation here */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_read(EventSet, values) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Do some computation here */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_stop(EventSet, values) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">On
success, these functions return <FONT FACE="Courier New, monospace">PAPI_OK</FONT>
and on error, a non-zero error code is returned.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H3 CLASS="western"><A NAME="RESETTING_EVENT_SETS"></A><A NAME="7.3.5.RESETTING EVENTS IN AN EVENT SET|outline"></A>
RESETTING EVENTS IN AN EVENT SET</H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in; page-break-inside: avoid">
The hardware event counts in an event set can be reset to zero by
calling the following low-level function:</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_reset(<I>EventSet</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in; font-style: normal"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_reset(<I>EventSet</I>,
check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western" ALIGN=LEFT>ARGUMENT</H4>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><I><FONT FACE="Courier New, monospace">EventSet</FONT></I>
-- an integer handle for a PAPI event set as created by
<FONT FACE="Courier New, monospace">PAPI_create_eventset</FONT>.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">For
example, the <I><FONT FACE="Courier New, monospace">EventSet</FONT></I>
in the code example of the previous section could have been reset to
zero by adding the following lines:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">if
(PAPI_reset(EventSet) != PAPI_OK)</FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace">handle_error(1);</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">On success, this
function returns <FONT FACE="Courier New, monospace">PAPI_OK</FONT>
and on error, a non-zero error code is returned.</P>
<H3 CLASS="western"><A NAME="REMOVING_EVENT_SETS"></A><A NAME="7.3.6.REMOVING EVENTS IN AN EVENT SET|outline"></A>
REMOVING EVENTS IN AN EVENT SET</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">A hardware event and
an array of hardware events can be removed from an event set by
calling the following low-level functions, respectively:</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>C: </B>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_remove_event(<I>EventSet</I>,
<I>EventCode</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_remove_events(<I>EventSet</I>,
<I>EventCode</I>, <I>number</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0.19in; font-style: normal"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_remove_event(<I>EventSet</I>,
<I>EventCode</I>, check)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_remove_events(<I>EventSet</I>,
<I>EventCode</I>, <I>number</I>, check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western">ARGUMENTS</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>EventSet</I>
<FONT FACE="Verdana, sans-serif">-- an integer handle for a PAPI
event set as created by </FONT>PAPI_create_eventset<FONT FACE="Times New Roman, serif">.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>EventCode</I>
<FONT FACE="Verdana, sans-serif">-- a defined event such as
</FONT>PAPI_TOT_INS<FONT FACE="Verdana, sans-serif"> or a native
event.</FONT> </FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>*EventCode</I>
<FONT FACE="Verdana, sans-serif">-- an array of defined events.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>number</I>
<FONT FACE="Verdana, sans-serif">-- an integer indicating the number
of events in the array </FONT><I>*EventCode</I><FONT FACE="Verdana, sans-serif">.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_remove_event</FONT>
removes a single hardware event from a PAPI event set. 
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_remove_events</FONT>,
does the same as <FONT FACE="Courier New, monospace">PAPI_remove_event</FONT>,
but for an array of hardware event codes.</P>
<P CLASS="western" STYLE="margin-top: 0.17in; margin-bottom: 0.19in">In
the following code example, <FONT FACE="Courier New, monospace">PAPI_remove_event</FONT>
is used to remove the event, <FONT FACE="Courier New, monospace">PAPI_TOT_INS</FONT>,
from an event set:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;stdio.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
retval, EventSet = PAPI_NULL;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Initialize the PAPI library */</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= PAPI_library_init(PAPI_VER_CURRENT);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(retval != PAPI_VER_CURRENT) {</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stderr,
&quot;PAPI library init error!\n&quot;);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Create an EventSet */&nbsp;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_create_eventset(&amp;EventSet) != PAPI_OK)</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Add Total Instructions Executed to our EventSet */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_add_event(EventSet, PAPI_TOT_INS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Remove event */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_remove_event(EventSet, PAPI_TOT_INS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">On success, these
functions return <FONT FACE="Courier New, monospace">PAPI_OK</FONT>
and on error, a non-zero error code is returned.</P>
<H3 CLASS="western"><A NAME="EMPTYING_EVENT_SETS"></A><A NAME="7.3.7.EMPTYING AND DESTROYING AN EVENT SET|outline"></A>
EMPTYING AND DESTROYING AN EVENT SET</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">All the events in an
event set can be emptied and destroyed by calling the following
low-level functions, respectively:</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_cleanup_eventset(<I>EventSet</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_destroy_eventset(<I>EventSet</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0.19in; font-style: normal"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_cleanup_eventset(<I>EventSet</I>,
check)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_destroy_eventset(<I>EventSet</I>,
check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western">ARGUMENT</H4>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace"><I>EventSet</I>
</FONT>-- an integer handle for a PAPI event set as created by
<FONT FACE="Courier New, monospace">PAPI_create_eventset</FONT>.</P>
<P STYLE="margin-bottom: 0.19in"><B><SPAN STYLE="font-style: normal">Note
that the event set must be empty in order to use
<FONT FACE="Courier New, monospace">PAPI_destroy_eventset</FONT>.</SPAN></B></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In the following
code example, <FONT FACE="Courier New, monospace">PAPI_cleanup_eventset</FONT>
is used to empty all the events from an event set<I> </I>and
<FONT FACE="Courier New, monospace">PAPI_remove_eventset</FONT> is
used to deallocate the memory associated with the empty event set:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;stdio.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in">   
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
retval, EventSet = PAPI_NULL;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Initialize the PAPI library */</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= PAPI_library_init(PAPI_VER_CURRENT);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(retval != PAPI_VER_CURRENT) {</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stderr,
&quot;PAPI library init error!\n&quot;);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Create the EventSet */ </FONT></FONT></FONT></FONT>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_create_eventset(&amp;EventSet) != PAPI_OK)</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   
<FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Add Total Instructions Executed to our EventSet */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_add_event(&amp;EventSet, PAPI_TOT_INS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Remove all events in the eventset */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_cleanup_eventset(&amp;EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Free all memory and data structures, EventSet must be empty. */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_destroy_eventset(&amp;EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">On success, these
functions return <FONT FACE="Courier New, monospace">PAPI_OK</FONT>
and on error, a non-zero error code is returned.</P>
<H3 CLASS="western"><A NAME="STATE_EVENT_SETS"></A><A NAME="7.3.8.THE STATE OF AN EVENT SET|outline"></A>
THE STATE OF AN EVENT SET</H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">The
counting state of an Event Set can be obtained by calling the
following low-level function:</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_state(<I>EventSet,
*status</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">	</FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_state(<I>EventSet</I>,
<I>status</I>, check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western" ALIGN=LEFT>ARGUMENTS</H4>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-right: 0.5in; margin-top: 0.19in; margin-bottom: 0.19in">
<I><FONT FACE="Courier New, monospace">EventSet</FONT></I> -- an
integer handle for a PAPI event set as created by
<FONT FACE="Courier New, monospace">PAPI_create_eventset</FONT>.</P>
<P ALIGN=JUSTIFY STYLE="margin-right: 0.5in; margin-top: 0.19in; margin-bottom: 0.19in">
<I><FONT FACE="Courier New, monospace">status</FONT></I><FONT FACE="Times New Roman, serif">
</FONT>-- an integer containing a Boolean combination of one or more
of the following nonzero constants as defined in the PAPI header
file,<FONT FACE="Times New Roman, serif"> </FONT><FONT FACE="Courier New, monospace">papi.h:</FONT><FONT FACE="Times New Roman, serif">
</FONT>
</P>
<TABLE WIDTH=632 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=7 CELLSPACING=0>
	<COL WIDTH=193>
	<COL WIDTH=409>
	<TR VALIGN=TOP>
		<TD WIDTH=193 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY><FONT FACE="Courier New, monospace">PAPI_STOPPED</FONT></P>
		</TD>
		<TD WIDTH=409 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY><I>EventSet</I> is stopped</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=193 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY><FONT FACE="Courier New, monospace">PAPI_RUNNING</FONT></P>
		</TD>
		<TD WIDTH=409 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY><I>EventSet</I> is running</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=193 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY><FONT FACE="Courier New, monospace">PAPI_PAUSED</FONT></P>
		</TD>
		<TD WIDTH=409 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY><I>EventSet </I>temporarily
			disabled by the library</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=193 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY><FONT FACE="Courier New, monospace">PAPI_NOT_INIT</FONT></P>
		</TD>
		<TD WIDTH=409 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY><I>EventSet</I> defined, but not
			initialized</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=193 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY><FONT FACE="Courier New, monospace">PAPI_OVERFLOWING</FONT></P>
		</TD>
		<TD WIDTH=409 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY><I>EventSet</I> has overflow
			enabled</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=193 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY><FONT FACE="Courier New, monospace">PAPI_PROFILING</FONT></P>
		</TD>
		<TD WIDTH=409 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY><I>EventSet</I> has profiling
			enabled</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=193 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY><FONT FACE="Courier New, monospace">PAPI_MULTIPLEXING</FONT></P>
		</TD>
		<TD WIDTH=409 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY><I>EventSet</I> has multiplexing
			enabled</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=193 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY><FONT FACE="Courier New, monospace">PAPI_ATTACHED</FONT></P>
		</TD>
		<TD WIDTH=409 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY><I>EventSet</I> <SPAN LANG="">is
			attached to another thread/process</SPAN></P>
		</TD>
	</TR>
</TABLE>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">In the
following code example, <FONT FACE="Courier New, monospace">PAPI_state</FONT>
is used to return the counting state of an <I><FONT FACE="Courier New, monospace">EventSet</FONT></I>:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;stdio.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>main
()</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
retval, status = 0, EventSet = PAPI_NULL;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Initialize the PAPI library */</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= PAPI_library_init(PAPI_VER_CURRENT);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(retval != PAPI_VER_CURRENT) {</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stderr,
&quot;PAPI library init error!\n&quot;);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Create the EventSet */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_create_eventset(&amp;EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Add Total Instructions Executed to our EventSet */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_add_event(&amp;EventSet, PAPI_TOT_INS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Start counting */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_state(EventSet, &amp;status) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;State
is now %d\n&quot;, status);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_start(EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_state(EventSet, &amp;status) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;State
is now %d\n&quot;, status);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H4 CLASS="western">OUTPUT:</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>State
is now 1</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>State
is now 2</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">On
success, this function returns <FONT FACE="Courier New, monospace">PAPI_OK</FONT>
and on error, a non-zero error code is returned.</P>
<H3 CLASS="western" STYLE="page-break-before: always"><A NAME="GETTING_OPTIONS"></A><A NAME="7.3.9.GETTING AND SETTING OPTIONS|outline"></A>
GETTING AND SETTING OPTIONS</H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">The
options of the PAPI library or a specific event set can be obtained
and set by calling the following low-level functions, respectively:</P>
<P ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in; font-style: normal"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_get_opt(<I>option</I>,
<I>ptr</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_set_opt(<I>option</I>,
<I>ptr</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in; font-style: normal"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_get_clockrate(<I>clockrate</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_get_domain(<I>EventSet</I>,
<I>domain</I>, <I>mode</I>, check)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_get_granularity(<I>EventSet</I>,
granularity, <I>mode</I>, check)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_get_preload(<I>preload</I>,
check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western">ARGUMENTS</H4>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-right: 0.5in; margin-top: 0.19in; margin-bottom: 0.19in">
<I><FONT FACE="Courier New, monospace">option</FONT></I> -- is an
input parameter describing the course of action. The Fortran calls
are implementations of specific options. Possible values are defined
in <B><FONT FACE="Courier New, monospace">papi.h</FONT></B> and
briefly described below:</P>
<TABLE WIDTH=668 BORDER=1 BORDERCOLOR="#c0c0c0" CELLPADDING=3 CELLSPACING=3>
	<COL WIDTH=174>
	<COL WIDTH=471>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" STYLE="page-break-inside: avoid"><B>Option name</B></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" STYLE="page-break-inside: avoid"><B>Explanation</B></P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=654 VALIGN=TOP BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=CENTER STYLE="page-break-inside: avoid"><I><B>General
			information requests</B></I></P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_CLOCKRATE</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			clockrate in MHz. 
			</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_MAX_CPUS</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			number of CPUs.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_MAX_HWCTRS</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			number of counters.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_EXEINFO</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			Executable addresses for text/data/bss.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_HWINFO</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			information about the hardware.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_SHLIBINFO</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			shared library information used by the program.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_SUBSTRATEINFO</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			the PAPI features the substrate supports. 
			</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_LIB_VERSION</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			the full PAPI version of the library. 
			</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_PRELOAD</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			‘‘LD_PRELOAD’’ environment equivalent. 
			</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=654 VALIGN=TOP BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=CENTER STYLE="page-break-inside: avoid"><I><B>Defaults
			for the global library</B></I></P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_DEFDOM</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get/Set
			the default counting domain for newly created event sets. 
			</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_DEFGRN</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get/Set
			the default counting granularity. 
			</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_DEBUG</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get/Set
			the PAPI debug state and the debug handler. The available debug
			states are defined in papi.h. The debug state is available in
			ptr-&gt;debug.level. The debug handler is available in
			ptr-&gt;debug.handler. For information regarding the behavior of
			the handler, please see the man page for PAPI_set_debug.</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=654 VALIGN=TOP BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=CENTER STYLE="page-break-inside: avoid"><I><B>Multiplexing
			control</B></I></P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_
			MULTIPLEX</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get/Set
			options for multiplexing. 
			</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_MAX_MPX_CTRS</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			maximum number of multiplexing counters.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_DEF_MPX_USEC</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get/Set
			the sampling time slice in microseconds for multiplexing.</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=654 VALIGN=TOP BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=CENTER STYLE="page-break-inside: avoid"><I><B>Manipulating
			individual event sets</B></I></P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_ATTACH</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			thread or process id to which event set is attached. Returns TRUE
			if currently attached. Set event set specified in
			ptr-&gt;ptr-&gt;attach.eventset to be attached to thread or
			process id specified in in ptr-&gt;attach.tid.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_DETACH</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			thread or process id to which event set is attached. Returns TRUE
			if currently detached. Set event set specified in
			ptr-&gt;ptr-&gt;attach.eventset to be detached from any thread or
			process id.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_DOMAIN</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get/Set
			domain for a single event set. The event set is specified in
			ptr-&gt;domain.eventset 
			</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_GRANUL</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" STYLE="page-break-inside: avoid">Get/Set
			granularity for a single event set. The event set is specified in
			ptr-&gt;granularity.eventset. <BR>Currently unimplemented.</P>
		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=654 VALIGN=TOP BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=CENTER STYLE="page-break-inside: avoid"><I><B>Platform
			Specific Options</B></I></P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_DATA_ADDRESS</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Set
			data address range to restrict event counting for event set
			specified in ptr-&gt;addr.eventset. Starting and ending addresses
			are specified in ptr-&gt;addr.start and ptr-&gt;addr.end,
			respectively. If exact addresses cannot be instantiated, offsets
			are returned in ptr-&gt;addr.start_off and ptr-&gt;addr.end_off.
			Currently implemented on Itanium only.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=174 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_INSTR_ADDRESS</FONT></P>
		</TD>
		<TD WIDTH=471 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Set
			instruction address range as described above. Itanium only.</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>ptr</I>
<FONT FACE="Verdana, sans-serif">-- is a pointer to a structure that
acts as both an input and output parameter. It is defined in </FONT><B>papi.h</B><FONT FACE="Verdana, sans-serif">
and below.</FONT> </FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>EventSet</I><FONT FACE="Verdana, sans-serif">
-- input; a reference to an </FONT>EventSetInfo<FONT FACE="Verdana, sans-serif">
structure</FONT><FONT FACE="Times New Roman, serif"> </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>clockrate</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- output; cycle time of this
CPU in MHz; *may* be an estimate generated at init time with a quick
timing routine </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>domain</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- output; execution domain
for which events are counted </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>granularity</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- output; execution
granularity for which events are counted </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>mode</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- input; determines if
domain or granularity are default or for the current event set </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>preload</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- output; environment
variable string for preloading libraries </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_get_opt</FONT>
and <FONT FACE="Courier New, monospace">PAPI_set_opt</FONT> query or
change the options of the PAPI library or a specific event set
created by <FONT FACE="Courier New, monospace">PAPI_create_eventset</FONT>.
In the C interface, these functions pass a pointer to the
<I><FONT FACE="Courier New, monospace">PAPI_option_t</FONT></I>
structure. Not all options require or return information in this
structure. The Fortran interface is a series of calls implementing
various subsets of the C interface. <B>Not all options in C are
available in Fortran.</B></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">Note
that a number of options are available as separate entry points in
both C and Fortran. This can make calling sequences simpler. Calls
that are simply wrappers to <FONT FACE="Courier New, monospace">PAPI_get_opt</FONT>
and <FONT FACE="Courier New, monospace">PAPI_set_opt</FONT> are
listed below:</P>
<TABLE WIDTH=668 BORDER=1 BORDERCOLOR="#c0c0c0" CELLPADDING=3 CELLSPACING=3>
	<COL WIDTH=234>
	<COL WIDTH=411>
	<TR VALIGN=TOP>
		<TD WIDTH=234 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_get_executable_info
			 </FONT>
			</P>
		</TD>
		<TD WIDTH=411 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			the executable’s address space information.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=234 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_get_hardware_info
			 </FONT>
			</P>
		</TD>
		<TD WIDTH=411 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			information about the system hardware.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=234 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_get_multiplex
			 </FONT>
			</P>
		</TD>
		<TD WIDTH=411 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			the multiplexing status of specified event set.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=234 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_get_shared_lib_info
			 </FONT>
			</P>
		</TD>
		<TD WIDTH=411 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			information about the shared libraries used by the process.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=234 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_get_substrate_info
			 </FONT>
			</P>
		</TD>
		<TD WIDTH=411 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get
			information about the substrate features.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=234 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_set_debug
			 </FONT>
			</P>
		</TD>
		<TD WIDTH=411 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Set
			the current debug level for PAPI.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=234 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_set_domain
			 </FONT>
			</P>
		</TD>
		<TD WIDTH=411 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Set
			the default execution domain for new event sets.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=234 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_set_granularity
			 </FONT>
			</P>
		</TD>
		<TD WIDTH=411 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Get/Set
			the default granularity for new event sets.</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=234 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid"><FONT FACE="Courier New, monospace">PAPI_set_multiplex
			 </FONT>
			</P>
		</TD>
		<TD WIDTH=411 BGCOLOR="#d9d9d9">
			<P CLASS="western" ALIGN=JUSTIFY STYLE="page-break-inside: avoid">Convert
			a standard event set to a multiplexed event set.</P>
		</TD>
	</TR>
</TABLE>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The <I><FONT FACE="Courier New, monospace">PAPI_option_t</FONT></I>
structure is actually a union of structures that provide specific
information for each of the options defined in the table above. This
union is defined as shown below:</P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: avoid; page-break-before: always">
   <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">typedef</FONT>
<FONT COLOR="#0000ff">union</FONT> {</FONT></FONT></SPAN></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: avoid">
      <FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_preload_info_t
preload;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: avoid">
      <FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_debug_option_t
debug;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: avoid">
      <FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_granularity_option_t
granularity;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: avoid">
      <FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_granularity_option_t
defgranularity;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: avoid">
      <FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_domain_option_t
domain;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: avoid">
      <FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_domain_option_t
defdomain;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: avoid">
      <FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_attach_option_t
attach;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: avoid">
      <FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_multiplex_option_t
multiplex;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: avoid">
      <FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_hw_info_t
*hw_info;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: avoid">
      <FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_shlib_info_t
*shlib_info;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: avoid">
      <FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_exe_info_t
*exe_info;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: avoid">
      <FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_substrate_info_t
*sub_info;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: avoid">
      <FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_addr_range_option_t
addr;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in; page-break-inside: avoid">
   <FONT FACE="Courier New, monospace"><FONT SIZE=2>} PAPI_option_t;</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Each of these
individual structures, as defined in <B><FONT FACE="Courier New, monospace">papi.h</FONT></B>,
is shown below:</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in; page-break-after: avoid">
<B>For <FONT FACE="Courier New, monospace">PAPI_PRELOAD:</FONT></B></P>
<P CLASS="western" STYLE="margin-bottom: 0in">   <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">typedef</FONT>
<FONT COLOR="#0000ff">struct</FONT> _papi_preload_option {</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">char</FONT>
lib_preload_env[PAPI_MAX_STR_LEN];   </FONT></FONT></SPAN>
</P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">char</FONT>
lib_preload_sep;</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">char</FONT>
lib_dir_env[PAPI_MAX_STR_LEN];</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">char</FONT>
lib_dir_sep;</FONT></FONT></SPAN></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>}
PAPI_preload_info_t;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in; page-break-after: avoid">
<B>For <FONT FACE="Courier New, monospace">PAPI_DEBUG:</FONT></B></P>
<P CLASS="western" STYLE="margin-bottom: 0in">   <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">typedef</FONT>
<FONT COLOR="#0000ff">int</FONT> (*PAPI_debug_handler_t) (<FONT COLOR="#0000ff">int</FONT>
code);</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">   <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">typedef</FONT>
<FONT COLOR="#0000ff">struct</FONT> _papi_debug_option {</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
level;</FONT></FONT></SPAN></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in">     
<FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_debug_handler_t
handler;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>}
PAPI_debug_option_t;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in; page-break-after: avoid">
<B>For <FONT FACE="Courier New, monospace">PAPI_DEFGRN </FONT>and<FONT FACE="Courier New, monospace">
PAPI_GRANUL:</FONT></B></P>
<P CLASS="western" STYLE="margin-bottom: 0in">   <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">typedef</FONT>
<FONT COLOR="#0000ff">struct</FONT> _papi_granularity_option {</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
eventset;</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
granularity;</FONT></FONT></SPAN></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>}
PAPI_granularity_option_t;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in; page-break-after: avoid">
<B>For <FONT FACE="Courier New, monospace">PAPI_DEFDOM </FONT>and<FONT FACE="Courier New, monospace">
PAPI_DOMAIN:</FONT></B></P>
<P CLASS="western" STYLE="margin-bottom: 0in">   <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">typedef</FONT>
<FONT COLOR="#0000ff">struct</FONT> _papi_domain_option {</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
eventset;</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
domain;</FONT></FONT></SPAN></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>}
PAPI_domain_option_t;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in; page-break-after: avoid">
<B>For <FONT FACE="Courier New, monospace">PAPI_ATTACH </FONT>and<FONT FACE="Courier New, monospace">
PAPI_DETACH:</FONT></B></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
   <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">typedef</FONT>
<FONT COLOR="#0000ff">struct</FONT> _papi_attach_option {</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
eventset;</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">long</FONT> tid;</FONT></FONT></SPAN></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>}
PAPI_attach_option_t;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in; page-break-after: avoid">
<B>For <FONT FACE="Courier New, monospace">PAPI_MULTIPLEX </FONT>and<FONT FACE="Courier New, monospace">
<SPAN LANG="">PAPI_DEF_MPX_USEC</SPAN>:</FONT></B></P>
<P CLASS="western" STYLE="margin-bottom: 0in">   <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">typedef</FONT>
<FONT COLOR="#0000ff">struct</FONT> _papi_multiplex_option {</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
eventset;</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
us;</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
flags;</FONT></FONT></SPAN></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>}
PAPI_multiplex_option_t;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in; page-break-after: avoid">
<B>For <FONT FACE="Courier New, monospace">PAPI_HWINFO:</FONT></B></P>
<P CLASS="western" STYLE="margin-bottom: 0in">   <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">typedef</FONT>
<FONT COLOR="#0000ff">struct</FONT> _papi_hw_info {</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
ncpu;                 <FONT COLOR="#008000">/* Number of CPU's in an
SMP Node */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
nnodes;               <FONT COLOR="#008000">/* Number of Nodes in the
entire system */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
totalcpus;            <FONT COLOR="#008000">/* Total number of CPU's
in the entire system */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
vendor;               <FONT COLOR="#008000">/* Vendor number of CPU
*/</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">char</FONT>
vendor_string[PAPI_MAX_STR_LEN];     <FONT COLOR="#008000">/* Vendor
string of CPU */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
model;                <FONT COLOR="#008000">/* Model number of CPU */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">char</FONT>
model_string[PAPI_MAX_STR_LEN];      <FONT COLOR="#008000">/* Model
string of CPU */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">float</FONT>
revision;           <FONT COLOR="#008000">/* Revision of CPU */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">float</FONT>
mhz;                <FONT COLOR="#008000">/* Cycle time of this CPU
*/</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace">PAPI_mh_info_t
mem_hierarchy;  <FONT COLOR="#008000">/* PAPI memory heirarchy
description */</FONT></FONT></FONT></SPAN></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>}
PAPI_hw_info_t;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in; page-break-after: avoid">
<B>For <FONT FACE="Courier New, monospace">PAPI_SHLIBINFO </FONT>and<FONT FACE="Courier New, monospace">
<SPAN LANG="">PAPI_EXEINFO</SPAN>:</FONT></B></P>
<P CLASS="western" STYLE="margin-bottom: 0in">   <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">typedef</FONT>
<FONT COLOR="#0000ff">struct</FONT> _papi_address_map {</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">char</FONT>
name[PAPI_HUGE_STR_LEN];</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace">caddr_t
text_start;       <FONT COLOR="#008000">/* Start address of program
text segment */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace">caddr_t
text_end;         <FONT COLOR="#008000">/* End address of program
text segment */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace">caddr_t
data_start;       <FONT COLOR="#008000">/* Start address of program
data segment */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace">caddr_t
data_end;         <FONT COLOR="#008000">/* End address of program
data segment */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace">caddr_t
bss_start;        <FONT COLOR="#008000">/* Start address of program
bss segment */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace">caddr_t
bss_end;          <FONT COLOR="#008000">/* End address of program bss
segment */</FONT></FONT></FONT></SPAN></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>}
PAPI_address_map_t;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0in">   <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">typedef</FONT>
<FONT COLOR="#0000ff">struct</FONT> _papi_shared_lib_info {</FONT></FONT></SPAN></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in">     
<FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_address_map_t
*map;</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
count;</FONT></FONT></SPAN></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>}
PAPI_shlib_info_t;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0in">   <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">typedef</FONT>
<FONT COLOR="#0000ff">struct</FONT> _papi_program_info {</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">char</FONT>
fullname[PAPI_HUGE_STR_LEN];  <FONT COLOR="#008000">/* path+name */</FONT></FONT></FONT></SPAN></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in">     
<FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_address_map_t
address_info;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>}
PAPI_exe_info_t;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in; page-break-after: avoid">
<B>For <FONT FACE="Courier New, monospace">PAPI_SUBSTRATEINFO:</FONT></B></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
   <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">typedef</FONT>
<FONT COLOR="#0000ff">struct</FONT> _papi_substrate_option {</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">char</FONT>
name[PAPI_MAX_STR_LEN];    <FONT COLOR="#008000">/* Name of the
substrate we're using,<BR>                                       
usually CVS RCS Id */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">char</FONT>
version[PAPI_MIN_STR_LEN]; <FONT COLOR="#008000">/* Version of this
substrate, <BR>                                        usually CVS
Revision */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">char</FONT>
support_version[PAPI_MIN_STR_LEN]; <FONT COLOR="#008000">/* Version
of the support library */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">char</FONT>
kernel_version[PAPI_MIN_STR_LEN];  <FONT COLOR="#008000">/* Version
of the kernel PMC <BR>                                               
support driver */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
num_cntrs;          <FONT COLOR="#008000">/* Number of hardware
counters substrate supports */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
num_mpx_cntrs;      <FONT COLOR="#008000">/* Number of multiplexed
counters the substrate or<BR>                                PAPI
supports */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
num_preset_events;   <FONT COLOR="#008000">/* Number of preset events
the substrate supports */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
num_native_events;   <FONT COLOR="#008000">/* Number of native events
the substrate supports */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
default_domain;      <FONT COLOR="#008000">/* The default domain when
this substrate is used */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
available_domains;   <FONT COLOR="#008000">/* Available domains */</FONT>
</FONT></FONT></SPAN>
</P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
default_granularity; <FONT COLOR="#008000">/* Default granularity
when this substrate is used */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
available_granularities; <FONT COLOR="#008000">/* Available
granularities */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
multiplex_timer_sig;     <FONT COLOR="#008000">/* Signal number used
by the multiplex timer,<BR>                                     0 if
not */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
multiplex_timer_num;     <FONT COLOR="#008000">/* Number of the
itimer or POSIX 1 timer used<BR>                                    
by the multiplex timer */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
multiplex_timer_us;      <FONT COLOR="#008000">/* uS between
switching of sets */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
hardware_intr_sig;     <FONT COLOR="#008000">/* Signal used by
hardware to deliver PMC events */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
opcode_match_width;    <FONT COLOR="#008000">/* Width of opcode
matcher if exists, 0 if not */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
reserved_ints[4];</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> hardware_intr:1; <FONT COLOR="#008000">/*
hw overflow intr, does not need to be<BR>                            
         emulated in software*/</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> precise_intr:1;  <FONT COLOR="#008000">/*
Performance interrupts happen precisely */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> posix1b_timers:1;  <FONT COLOR="#008000">/*
Using POSIX 1b interval timers<BR>                                   
   (timer_create) instead of setitimer */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> kernel_profile:1;   <FONT COLOR="#008000">/*
Has kernel profiling support (buffered<BR>                           
            interrupts or sprofil-like) */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> kernel_multiplex:1; <FONT COLOR="#008000">/*
In kernel multiplexing */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> data_address_range:1; <FONT COLOR="#008000">/*
Supports data address range limiting */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> instr_address_range:1; <FONT COLOR="#008000">/*
Supports instruction address range<BR>                               
            limiting */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> fast_counter_read:1;   <FONT COLOR="#008000">/*
Supports user level PMC read</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in"><FONT COLOR="#008000"> 
                                          <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace">instruction
*/</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> fast_real_timer:1;     <FONT COLOR="#008000">/*
Supports a fast real timer */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> fast_virtual_timer:1;  <FONT COLOR="#008000">/*
Supports a fast virtual timer */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> attach:1;		     <FONT COLOR="#008000">/*
Supports attach */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> attach_must_ptrace:1;  <FONT COLOR="#008000">/*
Attach must first ptrace and </FONT></FONT></FONT></SPAN>
</P>
<P CLASS="western" STYLE="margin-bottom: 0in"><FONT COLOR="#008000"> 
                                          <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace">stop
the thread/process*/</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> edge_detect:1;         <FONT COLOR="#008000">/*
Supports edge detection on events */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> invert:1;              <FONT COLOR="#008000">/*
Supports invert detection on events */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> profile_ear:1;         <FONT COLOR="#008000">/*
Supports data/instr/tlb miss</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in"><FONT COLOR="#008000"> 
                                          <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace">address
sampling */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> grouped_cntrs:1;   <FONT COLOR="#008000">/*
Underlying hardware uses counter groups */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in">     <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">unsigned</FONT>
<FONT COLOR="#0000ff">int</FONT> reserved_bits:16;</FONT></FONT></SPAN></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>}
PAPI_substrate_info_t;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in; page-break-after: avoid">
<B>For <FONT FACE="Courier New, monospace">PAPI_DATA_ADDRESS </FONT>and<FONT FACE="Courier New, monospace">
<SPAN LANG="">PAPI_INSTR_ADDRESS</SPAN>:</FONT></B></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
   <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#008000">/*
address range specification for range restricted counting */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
   <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">typedef</FONT>
<FONT COLOR="#0000ff">struct</FONT> _papi_addr_range_option { <FONT COLOR="#008000">/*
if both are zero, range disabled */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
eventset;           <FONT COLOR="#008000">/* eventset to restrict */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace">caddr_t
start;          <FONT COLOR="#008000">/* user requested start address
of address range */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace">caddr_t
end;            <FONT COLOR="#008000">/* user requested end address
of an address range */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
start_off;          <FONT COLOR="#008000">/* hardware specified
offset from start address */</FONT></FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="margin-bottom: 0in; page-break-after: avoid">
      <SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT COLOR="#0000ff">int</FONT>
end_off;            <FONT COLOR="#008000">/* hardware specified
offset from end address */</FONT></FONT></FONT></SPAN></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>}
PAPI_addr_range_option_t;</FONT></FONT></P>
<P LANG="" CLASS="western" STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The file, <B><FONT FACE="Courier New, monospace">papi.h</FONT></B>,
contains current definitions for the structures unioned in the
<I><FONT FACE="Courier New, monospace">PAPI_option_t</FONT></I>
structure. Users should refer to <B><FONT FACE="Courier New, monospace">papi.h</FONT></B>
for specifics on the use of fields in these structures.</P>
<P CLASS="western" STYLE="margin-top: 0.17in; margin-bottom: 0.19in">In
the following code example, <FONT FACE="Courier New, monospace">PAPI_get_opt</FONT>
is used to acquire the option, <FONT FACE="Courier New, monospace">PAPI_MAX_HWCTRS</FONT>,
of an event set and <FONT FACE="Courier New, monospace">PAPI_set_opt</FONT>
is used to set the option, <FONT FACE="Courier New, monospace">PAPI_DOMAIN</FONT>,
to the same event set:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;stdio.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in">&nbsp;</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
num, retval, EventSet = PAPI_NULL;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_option_t
options;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">&nbsp;</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Initialize the PAPI library */</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= PAPI_library_init(PAPI_VER_CURRENT);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">&nbsp;</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(retval != PAPI_VER_CURRENT) {</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stderr,
&quot;PAPI library init error!\n&quot;);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">&nbsp;</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
((num = PAPI_get_opt(PAPI_MAX_HWCTRS,NULL)) &lt;= 0)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error();</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">&nbsp;</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;This
machine has %d counters.0,num);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">&nbsp;</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_create_eventset(&amp;EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error();</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">&nbsp;</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Set the domain of this EventSet</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>to
counter user and kernel modes for this</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>process
*/</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>memset(&amp;options,0x0,sizeof(options));</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">&nbsp;</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>options.domain.eventset
= EventSet;</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>options.domain.domain
= PAPI_DOM_ALL;</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_set_opt(PAPI_DOMAIN, &amp;options) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error();</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in; font-style: normal"><BR><BR>
</P>
<H4 CLASS="western">POSSIBLE OUTPUT (VARIES ON DIFFERENT PLATFORMS):</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>This
machine has 4 counters.</FONT></FONT></P>
<P ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in; font-style: normal"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">On success, these
functions return <FONT FACE="Courier New, monospace">PAPI_OK</FONT>
and on error, a non-zero error code is returned.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.19in">For
more code examples, see <FONT FACE="Courier New, monospace">ctests/second.c</FONT>
or <FONT FACE="Courier New, monospace">ctests/third.c</FONT> in the
PAPI source distribution.</P>
<H2 CLASS="western"><A NAME="SIMPLE_CODE_EXAMPLES"></A><A NAME="7.4.SIMPLE CODE EXAMPLES|outline"></A>
SIMPLE CODE EXAMPLES</H2>
<H3 CLASS="western"><A NAME="HIGH_LEVEL_EXAMPLE"></A><A NAME="7.4.1.HIGH-LEVEL API|outline"></A>
HIGH-LEVEL API</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The following is a
simple code example of using the high-level API:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#define
NUM_FLOPS 10000</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#define
NUM_EVENTS 1</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
Events[NUM_EVENTS] = {PAPI_TOT_INS};</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>long_long
values[NUM_EVENTS];</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Start counting events */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_start_counters(Events, NUM_EVENTS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Defined in tests/do_loops.c in the PAPI source distribution */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>do_flops(NUM_FLOPS);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Read the counters */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_read_counters(values, NUM_EVENTS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;After
reading the counters: %lld\n&quot;,values[0]);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>do_flops(NUM_FLOPS);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Add the counters */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_accum_counters(values, NUM_EVENTS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;After
adding the counters: %lld\n&quot;, values[0]);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>do_flops(NUM_FLOPS);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Stop counting events */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_stop_counters(values, NUM_EVENTS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;After
stopping the counters: %lld\n&quot;, values[0]);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H4 CLASS="western">POSSIBLE OUTPUT:</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>After
reading the counters: 441027</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>After
adding the counters: 891959</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>After
stopping the counters: 443994</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Notice that on the
second line (after adding the counters) the value is approximately
twice as large as the first line (after reading the counters) because
<FONT FACE="Courier New, monospace">PAPI_read_counters</FONT> resets
and leaves the counters running, then <FONT FACE="Courier New, monospace">PAPI_accum_counters</FONT>
adds the value of the current counter into the <I>values</I> array. 
</P>
<H3 CLASS="western"><A NAME="LOW_LEVEL_EXAMPLE"></A><A NAME="7.4.2.LOW-LEVEL API|outline"></A>
LOW-LEVEL API</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The following is a
simple code example that applies the same technique as the above
example, except it uses the Low-Level API:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;stdio.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#define
NUM_FLOPS 10000</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
retval, EventSet=PAPI_NULL;</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>long_long
values[1];</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Initialize the PAPI library */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= PAPI_library_init(PAPI_VER_CURRENT);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(retval != PAPI_VER_CURRENT) {</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stderr,
&quot;PAPI library init error!\n&quot;);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Create the Event Set */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_create_eventset(&amp;EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Add Total Instructions Executed to our Event Set */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_add_event(EventSet, PAPI_TOT_INS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Start counting events in the Event Set */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_start(EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Defined in tests/do_loops.c in the PAPI source distribution */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>do_flops(NUM_FLOPS);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Read the counting events in the Event Set */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_read(EventSet, values) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;After
reading the counters: %lld\n&quot;,values[0]);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Reset the counting events in the Event Set */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_reset(EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>do_flops(NUM_FLOPS);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Add the counters in the Event Set */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_accum(EventSet, values) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;After
adding the counters: %lld\n&quot;,values[0]);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>do_flops(NUM_FLOPS);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Stop the counting of events in the Event Set */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_stop(EventSet, values) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">   
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;After
stopping the counters: %lld\n&quot;,values[0]);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H4 CLASS="western">POSSIBLE OUTPUT:</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>After
reading the counters: 440973</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>After
adding the counters: 882256</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>After
stopping the counters: 443913</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western">Notice that in order to get the desired results
(the second line approximately twice as large as the first line),
PAPI_reset was called to reset the counters, since PAPI_read did not
reset the counters.</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="PAPI_TIMERS"></A><A NAME="8.PAPI TIMERS	|outline"></A>
PAPI TIMERS	</H1>
<P CLASS="western">PAPI timers use the most accurate timers available
on the platform in use. These timers can be used to obtain both real
and virtual time on each supported platform. The real time clock runs
all the time (e.g. a wall clock) and the virtual time clock runs only
when the processor is running in user mode.</P>
<H2 CLASS="western"><A NAME="REAL_TIME"></A><A NAME="8.1.REAL TIME|outline"></A>
REAL TIME</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Real time can be
acquired in clock cycles and microseconds by calling the following
low-level functions, respectively:</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_get_real_cyc()</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_get_real_usec()</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_get_real_cyc(check)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_get_real_usec(check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Both of these
functions return the total real time passed since some arbitrary
starting point and are equivalent to wall clock time. Also, <I>these
functions always succeed (error-free) since they are guaranteed to
exist on every PAPI supported platform.</I></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In the following
code example, <FONT FACE="Courier New, monospace">PAPI_get_real_cyc</FONT>
and <FONT FACE="Courier New, monospace">PAPI_get_real_usec</FONT> are
used to obtain the real time it takes to create an event set in clock
cycles and microseconds, respectively:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"> <FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>long_long
start_cycles, end_cycles, start_usec, end_usec;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
EventSet = PAPI_NULL;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_library_init(PAPI_VER_CURRENT) != PAPI_VER_CURRENT)</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Gets the starting time in clock cycles */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>start_cycles
= PAPI_get_real_cyc();</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Gets the starting time in microseconds */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>start_usec
= PAPI_get_real_usec();</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*Create
an EventSet */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_create_eventset(&amp;EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);<BR></FONT></FONT><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Gets the ending time in clock cycles */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>end_cycles
= PAPI_get_real_cyc();</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Gets the ending time in microseconds */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>end_usec
= PAPI_get_real_usec();</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;Wall
clock cycles: %lld\n&quot;, end_cycles - start_cycles);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>prinf(“Wall
clock time in microseconds: %lld\n”, end_usec - start_usec); </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H4 CLASS="western">POSSIBLE OUTPUT:</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Wall
clock cycles: 100173</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Wall
clock time in microseconds: 136</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H2 CLASS="western"><A NAME="VIRTUAL_TIME"></A><A NAME="8.2.VIRTUAL TIME|outline"></A>
VIRTUAL TIME</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Virtual time can be
acquired in clock cycles and microseconds by calling the following
low-level functions, respectively:</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_get_virt_cyc()</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_get_virt_usec()</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_get_virt_cyc(check)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_get_virt_usec(check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Both of these
functions return the total number of virtual units from some
arbitrary starting point. Virtual units accrue every time a process
is running in user-mode. <I>Like the real time counters, these
functions always succeed (error-free) since they are guaranteed to
exist on every PAPI supported platform.</I> However, the resolution
can be as bad as 1/Hz as defined by the operating system on some
platforms.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In the following
code example, <FONT FACE="Courier New, monospace">PAPI_get_virt_cyc</FONT>
and <FONT FACE="Courier New, monospace">PAPI_get_virt_usec</FONT> are
used to obtain the virtual time it takes to create an event set in
clock cycles and microseconds, respectively:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>long_long
start_cycles, end_cycles, start_usec, end_usec;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
EventSet = PAPI_NULL;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_library_init(PAPI_VER_CURRENT) != PAPI_VER_CURRENT)</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Gets the starting time in clock cycles */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>start_cycles
= PAPI_get_virt_cyc();</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Gets the starting time in microseconds */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>start_usec
= PAPI_get_virt_usec();</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*Create
an EventSet */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_create_eventset(&amp;EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);<BR></FONT></FONT><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Gets the ending time in clock cycles */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>end_cycles
= PAPI_get_virt_cyc();</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Gets the ending time in microseconds */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>end_usec
= PAPI_get_virt_usec();</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;Virtual
clock cycles: %lld\n&quot;, end_cycles - start_cycles);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>prinf(“Virtual
clock time in microseconds: %lld\n”, end_usec - start_usec); </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H4 CLASS="western">POSSIBLE OUTPUT:</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Virtual
clock cycles: 715408</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Virtual
clock time in microseconds: 976</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="PAPI_SYSTEM_INFO"></A><A NAME="9.PAPI SYSTEM INFORMATION	|outline"></A>
PAPI SYSTEM INFORMATION	</H1>
<H2 CLASS="western"><A NAME="EXECUTABLE_INFO"></A><A NAME="9.1.EXECUTABLE INFORMATION|outline"></A>
EXECUTABLE INFORMATION</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Information about
the executable’s address space can be obtained by using the
following low-level function:</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_get_executable_info()</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPIF_get_exe_info(<I>fullname,
name, text_start, text_end, data_start, data_end, bss_start, bss_end,
lib_preload_env</I>, check)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western">ARGUMENTS</H4>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The following
arguments are implicit in the structure returned by the C function,
or explicitly returned by Fortran: 
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>fullname</I>
<FONT FACE="Verdana, sans-serif">-- fully qualified path + filename
of the executable</FONT> </FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>name</I>
<FONT FACE="Verdana, sans-serif">-- filename of the executable with
no path information </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>text_start,
text_end</I> <FONT FACE="Verdana, sans-serif">-- Start and End
addresses of program text segment </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>data_start,
data_end</I> <FONT FACE="Verdana, sans-serif">-- Start and End
addresses of program data segment </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>bss_start,
bss_end</I> <FONT FACE="Verdana, sans-serif">-- Start and End
addresses of program bss segment </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>lib_preload_env</I>
<FONT FACE="Verdana, sans-serif">-- environment variable for
preloading libraries </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><B><FONT SIZE=3><FONT FACE="Verdana, sans-serif">Note
that the arguments, <I>text_start</I> and <I>text_end</I>, are the
only fields that are filled on every architecture.</FONT></FONT></B></FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In C, this function
returns a pointer to a structure containing information about the
current program, such as the start and end addresses of the text,
data, and bss segments. 
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In Fortran, the
fields of the structure are returned explicitly.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In the following
code example, <FONT FACE="Courier New, monospace">PAPI_get_executable_info</FONT>
is used to acquire information about the start and end addresses of
the program’s text segment:</P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;stdio.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>const
PAPI_exe_info_t *prginfo = NULL;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_library_init(PAPI_VER_CURRENT) != PAPI_VER_CURRENT)</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
((prginfo = PAPI_get_executable_info()) == NULL)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;Start
of user program is at %p\n&quot;,prginfo-&gt;text_start);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;End
of user program is at %p\n&quot;,prginfo-&gt;text_end);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western">POSSIBLE OUTPUT:</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Start
of user program is at 0x4000000000000f20</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>End
of user program is at 0x4000000000034e00</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In C, on success,
the function returns a non-<FONT FACE="Courier New, monospace">NULL</FONT>
pointer and on error, <FONT FACE="Courier New, monospace">NULL</FONT>
is returned.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In Fortran, on
success, the function returns <FONT FACE="Courier New, monospace">PAPI_OK</FONT>
and on error, a non-zero error code is returned.</P>
<H2 CLASS="western"><A NAME="HARDWARE_INFO"></A><A NAME="9.2.HARDWARE INFORMATION|outline"></A>
HARDWARE INFORMATION</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Information about
the system hardware can be obtained by using the following low-level
function:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Verdana, sans-serif"><FONT SIZE=3><B>C:</B></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_get_hardware_info()</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Verdana, sans-serif"><FONT SIZE=3><B>Fortran:</B></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_get_hardware_info
(<I>ncpu, nnodes, totalcpus, vendor, vendor_string, model,
model_string, revision, mhz</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Verdana, sans-serif"><FONT SIZE=3><B>ARGUMENTS</B></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The following
arguments are implicit in the structure returned by the C function,
or explicitly returned by Fortran. 
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>ncpu</I>
<FONT FACE="Verdana, sans-serif">-- number of CPUs in an SMP Node </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>nnodes</I>
<FONT FACE="Verdana, sans-serif">-- number of Nodes in the entire
system </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>totalcpus</I>
<FONT FACE="Verdana, sans-serif">-- total number of CPUs in the
entire system </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>vendor</I>
<FONT FACE="Verdana, sans-serif">-- vendor id number of CPU </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>vendor_string</I>
<FONT FACE="Verdana, sans-serif">-- vendor id string of CPU </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>model</I>
<FONT FACE="Verdana, sans-serif">-- model number of CPU </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>model_string</I>
<FONT FACE="Verdana, sans-serif">-- model string of CPU </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>revision</I>
<FONT FACE="Verdana, sans-serif">-- Revision number of CPU </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>mhz</I>
<FONT FACE="Verdana, sans-serif">-- Cycle time of this CPU; *may* be
an estimate generated at initial time with a quick timing routine </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In C, this function
returns a pointer to a structure containing information about the
hardware on which the program runs, such as:  the number of CPUs, CPU
model information, and the cycle time of the CPU. 
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In Fortran, the
fields of the structure are returned explicitly.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><I>Note that if this
function were called before </I><FONT FACE="Courier New, monospace">PAPI_library_init</FONT><I>,
it would be undefined</I>.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In the following
code example, <FONT FACE="Courier New, monospace">PAPI_get_hardware_info</FONT>
is used to acquire hardware information about the total number of
CPUs and the cycle time of the CPU:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;stdio.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>const
PAPI_hw_info_t *hwinfo = NULL;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_library_init(PAPI_VER_CURRENT) != PAPI_VER_CURRENT)</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
((hwinfo = PAPI_get_hardware_info()) == NULL)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;%d
CPU’s at %f Mhz.\n&quot;,hwinfo-&gt;totalcpus,hwinfo-&gt;mhz);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western">POSSIBLE OUTPUT:</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>1
CPUs at 733.000000 Mhz.</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In C, on success,
this function returns a non-<FONT FACE="Courier New, monospace">NULL</FONT>
pointer and on error, <FONT FACE="Courier New, monospace">NULL</FONT>
is returned.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In Fortran, on
success, this function returns <FONT FACE="Courier New, monospace">PAPI_OK</FONT>
and on error, a non-zero error code is returned.</P>
<H2 CLASS="western" STYLE="page-break-before: always"><A NAME="9.3.SUBSTRATE INFORMATION|outline"></A>
SUBSTRATE INFORMATION</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Implementation
details about the current hardware dependent substrate can be
obtained by using the following low-level function:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Verdana, sans-serif"><FONT SIZE=3><B>C:</B></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_get_substrate_info()</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Verdana, sans-serif"><FONT SIZE=3><B>Fortran:</B></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Verdana, sans-serif"><FONT SIZE=3>This
call is not implemented in the Fortran interface.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Verdana, sans-serif"><FONT SIZE=3><B>ARGUMENTS</B></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In C, this function
returns a pointer to a structure containing implementation details
about the substrate currently in use, such as:  the number of
counters and multiplexed counters supported, the number of preset and
native events available, and whether (and how) certain advanced
features are supported. For more details, refer to the definition of
the <FONT FACE="Courier New, monospace">PAPI_substrate_info_t</FONT>
structure found in <B><FONT FACE="Courier New, monospace">papi.h</FONT></B>,
or see the discussion under getting and setting options. <I>Note: if
this function is called before </I><FONT FACE="Courier New, monospace">PAPI_library_init</FONT><I>,
its output is undefined</I>.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In the following
code example, <FONT FACE="Courier New, monospace">PAPI_get_substrate_info</FONT>
is used to determine how many preset and native events can be counted
for a given substrate:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;	</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;stdio.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>const
</FONT></FONT><SPAN LANG="">PAPI_substrate_info_t *subinfo </SPAN><FONT FACE="Courier New, monospace"><FONT SIZE=2>=
NULL;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>	</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_library_init(PAPI_VER_CURRENT) != PAPI_VER_CURRENT)</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
((<SPAN LANG="">subinfo </SPAN>= PAPI_get_substrate_info()) == NULL)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="text-indent: 0.33in; margin-bottom: 0in"><SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace">printf(<FONT COLOR="#800000">&quot;num_preset_events:
%d\n&quot;</FONT>,subinfo-&gt;num_preset_events);</FONT></FONT></SPAN></P>
<P CLASS="western" STYLE="text-indent: 0.33in; margin-bottom: 0in"><SPAN LANG=""><FONT SIZE=2><FONT FACE="Courier New, monospace">printf(<FONT COLOR="#800000">&quot;num_native_events:
%d\n&quot;</FONT>,subinfo-&gt;num_native_events);</FONT></FONT></SPAN></P>
<P STYLE="margin-bottom: 0in"> <FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western">POSSIBLE OUTPUT:</H4>
<P CLASS="western" STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>num_preset_events:
47</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>num_native_events:
193</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">On success, this
function returns a non-<FONT FACE="Courier New, monospace">NULL</FONT>
pointer and on error, <FONT FACE="Courier New, monospace">NULL</FONT>
is returned.</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="10.ADVANCED PAPI FEATURES	|outline"></A>
ADVANCED PAPI FEATURES	</H1>
<H2 CLASS="western"><A NAME="MULTIPLEXING"></A><A NAME="10.1.MULTIPLEXING|outline"></A>
MULTIPLEXING</H2>
<H2 CLASS="western"><A NAME="WHAT_IS_MULTIPLEXING"></A><A NAME="10.2.WHAT IS MULTIPLEXING_|outline"></A>
WHAT IS <FONT SIZE=4>MULTIPLEXING</FONT>?</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Multiplexing allows
more events to be counted than can be supported by the hardware. When
a microprocessor has a limited number of hardware counters, a large
application with many hours of run time may require days or weeks of
profiling in order to gather enough information on which to base a
performance analysis. Multiplexing overcomes this limitation by
subdividing the usage of the counter hardware over time (timesharing)
among a large number of performance events.</P>
<H3 CLASS="western"><A NAME="PAPI_MULTIPLEXING"></A><A NAME="10.2.1.USING PAPI WITH MULTIPLEXING|outline"></A>
USING PAPI WITH MULTIPLEXING</H3>
<H4 CLASS="western"><A NAME="INITIALIZATION_MULTIPLEXING"></A>INITIALIZATION
OF MULTIPLEX SUPPORT</H4>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Multiplex support in
the PAPI library can be enabled and initialized by calling the
following low-level function:</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_muliplex_init()</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_multiplex_init(check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The above function
sets up the internal structures to allow more events to be counted
than there are physical counters. It does this by timesharing the
existing counters at some loss in precision. <B>This function should
be used after calling <FONT FACE="Courier New, monospace">PAPI_library_init</FONT>.</B>
After this function is called, the user can proceed to use the normal
PAPI routines. <I>It</I> s<I>hould be also noted that applications
that make no use of multiplexing should not call this function.</I></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">On success, this
function returns <FONT FACE="Courier New, monospace">PAPI_OK</FONT>
and on error, a non-zero error code is returned.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">For a code example,
see the next section.</P>
<H4 CLASS="western"><A NAME="CONVERTING_TO_MULTIPLEXING"></A>CONVERTING
AN EVENT SET INTO A MULTIPLEXED EVENT SET</H4>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In addition, a
standard event set can be converted to a multiplexed event set by the
calling the following low-level function:</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_set_multiplex(<I>EventSet</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_set_multiplex(<I>EventSet</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western">ARGUMENT</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>EventSet</I>
<FONT FACE="Verdana, sans-serif">-- an integer handle for a PAPI
event set as created by </FONT>PAPI_create_eventset<FONT FACE="Verdana, sans-serif">.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The above function
converts a standard PAPI event set created by a call to
<FONT FACE="Courier New, monospace">PAPI_create_eventset</FONT> into
an event set capable of handling multiplexed events. <B>This function
must be used after calling <FONT FACE="Courier New, monospace">PAPI_multiplex_init</FONT>
and <FONT FACE="Courier New, monospace">PAPI_create_eventset</FONT>,
but prior to calling <FONT FACE="Courier New, monospace">PAPI_start</FONT>.</B>
Events can be added to an event set either before or after converting
it into a multiplexed set, but the conversion must be done prior to
using it as a multiplexed set.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In the following
code example, <FONT FACE="Courier New, monospace">PAPI_set_multiplex</FONT>
is used to convert a standard event set into a multiplexed event set:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
retval, i, EventSet = PAPI_NULL, max_to_add = 6, j = 0;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>long_long
*values;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>const
PAPI_preset_info_t *pset;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Initialize the PAPI library */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= PAPI_library_init(PAPI_VER_CURRENT);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(retval != PAPI_VER_CURRENT)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Enable and initialize multiplex support */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_multiplex_init() != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"> 
</P>
<P STYLE="margin-bottom: 0in"> <FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Create an<I> EventSet </I>*/</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_create_eventset(&amp;EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"> <FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Convert the <I>EventSet</I> to a multiplexed event set */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_set_multiplex(EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>for
(i=0;i&lt;PAPI_MAX_PRESET_EVENTS;i++)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
((PAPI_query_event (i | PAPI_PRESET) == PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>&amp;&amp;
((i | PAPI_PRESET) != PAPI_TOT_CYC))</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">&nbsp;&nbsp;&nbsp;  <FONT FACE="Courier New, monospace"><FONT SIZE=2>	if
(PAPI_add_event(&amp;EventSet, pset-&gt;event_code != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">            <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  
</P>
<P STYLE="margin-bottom: 0in">        <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(++j &gt;= max_to_add)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
   <FONT FACE="Courier New, monospace"><FONT SIZE=2>break;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>values
= (long_long *)malloc(max_to_add*sizeof(long_long));</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(values == NULL)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Start counting events */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_start(EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">On success, both
functions return <FONT FACE="Courier New, monospace">PAPI_OK</FONT>
and on error, a non-zero error code is returned.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">For more code
examples, see <FONT FACE="Courier New, monospace">ctests/multiplex1.c</FONT>
in the papi source distribution.</P>
<H3 CLASS="western"><A NAME="ISSUES_MULTPLEXING"></A><A NAME="10.2.2.ISSUES OF MULTIPLEXING|outline"></A>
ISSUES OF MULTIPLEXING</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The following are
some issues concerning multiplexing that the PAPI user should be
aware of:</P>
<UL>
	<LI><P CLASS="western" STYLE="margin-bottom: 0in"><B>Hardware
	multiplexing is not supported by all platforms.</B> On those
	platforms where it is supported, PAPI takes advantage of it.
	Otherwise, PAPI implements software multiplexing through the use of
	a high-resolution interval timer. For more information on which
	platforms support hardware or software multiplexing, see <FONT COLOR="#0000ff"><U><A HREF="#APPENDIX_H">Appendix
	H</A></U></FONT>. 
	</P>
	<LI><P CLASS="western" STYLE="margin-bottom: 0in">Multiplexing
	unavoidably incurs a small amount of overhead when switching events.
	In addition, no single event is measured for the full analysis time.
	These factors can adversely affect the precision of reported counter
	values. In other words, the more events that are multiplexed, the
	more likely that the results will be statistically skewed. The
	amount of time spent in the measured regions should be greater than
	the multiplexing time slice times the number of events measured in
	order to get acceptable results. 
	</P>
	<LI><P CLASS="western" STYLE="margin-bottom: 0in">The default time
	slice for multiplexing is currently set at 100000 microseconds.
	Occasionally this setting can cause a resonant situation in the code
	in which a given pattern repeats at the same frequency that timers
	are switched out. This can by addressed by changing the time slice
	setting by calling <FONT FACE="Courier New, monospace">PAPI_set_opt</FONT>
	with the <FONT FACE="Courier New, monospace">PAPI_DEF_MPX_USEC</FONT>
	option.</P>
	<LI><P CLASS="western" STYLE="margin-bottom: 0.19in">To prevent
	na&iuml;ve use of multiplexing by the novice user, the high level
	API can only access those events countable simultaneously by the
	underlying hardware, unless a low level function has been called to
	explicitly enable multiplexing.</P>
</UL>
<H2 CLASS="western"><A NAME="PAPI_PARELLEL"></A><A NAME="10.3.USING PAPI WITH PARALLEL PROGRAMS|outline"></A>
USING PAPI WITH PARALLEL PROGRAMS</H2>
<H3 CLASS="western"><A NAME="THREADS"></A><A NAME="10.3.1.THREADS|outline"></A>
THREADS</H3>
<H4 CLASS="western"><A NAME="WHAT_ARE_THREADS"></A>WHAT ARE THREADS?</H4>
<P CLASS="western" STYLE="margin-bottom: 0.19in">A thread is an
independent flow of instructions that can be scheduled to run by the
operating system. Multi-threaded programming is a form of parallel
programming where several controlled threads are executing
concurrently in the program. All threads execute in the same memory
space, and can therefore work concurrently on shared data. Threads
can run in parallel on several processors, allowing a single program
to divide its work between several processors, thus running faster
than a single-threaded program, which runs on only one processor at a
time.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">PAPI only supports
thread level measurements with <I>kernel or bound threads</I>, which
are threads that have a scheduling entity known and handled by the
operating system’s kernel. In most cases, such as with <FONT COLOR="#0000ff"><U><A HREF="http://www.tldp.org/HOWTO/SMP-HOWTO.html">SMP</A></U></FONT>
or <FONT COLOR="#0000ff"><U><A HREF="http://www.openmp.org/index.cgi?home">OpenMP</A></U></FONT>
complier directives, <I>bound</I> threads will be the default. Each
thread is responsible for the creation, start, stop, and read of its
own counters. When a thread is created, it inherits no PAPI
information from the calling thread. There are some threading
packages or APIs that can be used to manipulate threads with PAPI,
particularly <FONT COLOR="#0000ff"><U><A HREF="http://www.llnl.gov/computing/tutorials/workshops/workshop/pthreads/MAIN.html">Pthreads</A></U></FONT>
and OpenMP. For those using Pthreads, the user should take care to
set the scope of each thread to PTHREAD_SCOPE_SYSTEM attribute,
unless the system is known to have a non-hybrid thread library
implementation. 
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In addition, PAPI
does support <I>unbound or non-kernel threads</I>, but the counts
will reflect the total events for the process. Measurements that are
done in other threads will get all the same values, namely the counts
for the total process. For <I>unbound</I> threads, it is not
necessary to call PAPI_thread_init, which will be discussed in the
next section. 
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">When threads are in
use, PAPI allows the user to provide a routine to its library that
returns the thread ID of the currently running thread (for example,
pthreads_self for Pthreads) and this thread ID is used as a lookup
function for the internal data structures. 
</P>
<H4 CLASS="western"><A NAME="INITIALIZATION_THREADS"></A>INITIALIZATION
OF THREAD SUPPORT</H4>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Thread support in
the PAPI library can be initialized by calling the following
low-level function:</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_thread_init(<I>handle</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_thread_init(<I>handle</I>,
check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western">ARGUMENTS</H4>
<P CLASS="western" STYLE="margin-right: 0.5in; margin-top: 0.19in; margin-bottom: 0.19in">
<I><FONT FACE="Courier New, monospace">handle</FONT></I> -- Pointer
to a routine that returns the current thread ID. 
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>This function
should be called only once, just after <FONT FACE="Courier New, monospace">PAPI_library_init</FONT>,
and before any other PAPI calls.</B> If the function is called more
than once, the application will exit. Also, <I>applications that make
no use of threads do not need to call this function</I>.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The following
example shows the correct syntax for using <FONT FACE="Courier New, monospace">PAPI_thread_init</FONT>
with <B>OpenMP</B>:</P>
<P STYLE="margin-left: 0.25in; margin-right: 0.5in; margin-bottom: 0in">
<FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2><B><FONT SIZE=3>C:</FONT></B></FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;omp.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_thread_init(omp_get_thread_num) != PAPI_OK)</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.25in; margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace"><B>Fortran:</B></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
“fpapi.h”</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
“omp.h”</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>EXTERNAL
omp_get_thread_num</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>C
Fortran dictates that in order to a pass a subroutine</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>C
as an argument, the subroutine must be</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>C
declared external!</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>call
PAPIF_thread_init(omp_get_thread_num, error) </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">On success, the
function, <FONT FACE="Courier New, monospace">PAPI_thread_init</FONT>,
returns <FONT FACE="Courier New, monospace">PAPI_OK</FONT> and on
error, a non-zero error code is returned.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">For a code example
of using <FONT FACE="Courier New, monospace">PAPI_thread_init</FONT>
with Pthreads, see the next section.</P>
<H4 CLASS="western"><A NAME="THREAD_ID"></A>THREAD ID</H4>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The identifier of
the current thread can be obtained by calling the following low-level
function:</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_thread_id()</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_thread_id(check)</FONT></P>
<P STYLE="margin-bottom: 0in"> 
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">This function calls
the thread id function registered by <FONT FACE="Courier New, monospace">PAPI_thread_init</FONT>
and returns an unsigned long integer containing the thread
identifier.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In the following
code example, <FONT FACE="Courier New, monospace">PAPI_thread_init</FONT>
and <FONT FACE="Courier New, monospace">PAPI_thread_id</FONT> are
used to initialize thread support in the PAPI library and to acquire
the identifier of the current thread, respectively, with <B>Pthreads</B>:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;pthread.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>unsigned
long int tid;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_library_init(PAPI_VER_CURRENT) != PAPI_VER_CURRENT)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_thread_init(pthread_self) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
((tid = PAPI_thread_id()) == (unsigned long int)-1)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;Initial
thread id is: %lu\n&quot;,tid);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H4 CLASS="western">OUTPUT:</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Initial
thread id is: 0</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">On success, this
function returns a valid thread identifier and on error, <FONT FACE="Courier New, monospace">(unsigned
long int) –1</FONT> is returned.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Four more utility
functions related to threads are available in PAPI. These functions
allow you to register a newly created thread to make it available for
reference by PAPI, to remove a registered thread in cases where
thread ids may be reused by the system, and to create and access
thread-specific storage in a platform independent fashion for use
with PAPI. These functions are shown below:</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_register_thread()</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_unregister_thread()</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_get_thr_specific(<I>tag,
ptr</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_set_thr_specific(<I>tag,
ptr</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western">ARGUMENTS</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>tag</I>
<FONT FACE="Verdana, sans-serif">-- Integer value specifying one of 4
storage locations. </FONT>	</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>ptr</I>
<FONT FACE="Verdana, sans-serif">-- Pointer to the address of a data
structure. </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">For more code
examples of using Pthreads and OpenMP with PAPI, see
<FONT FACE="Courier New, monospace">ctests/zero_pthreads.c</FONT> and
<FONT FACE="Courier New, monospace">ctests/zero_omp.c</FONT> in the
papi source distribution, respectively. Also, for a code example of
using SMP with PAPI, see <FONT FACE="Courier New, monospace">ctests/zero_smp.c</FONT>
in the papi source distribution.</P>
<H3 CLASS="western"><A NAME="MPI"></A><A NAME="10.3.2.MPI|outline"></A>
MPI</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">MPI is an acronym
for <B>M</B>essage <B>P</B>assing <B>I</B>nterface. MPI is a library
specification for message-passing, proposed as a standard by a
broadly based committee of vendors, implementers, and users. MPI was
designed for high performance on both massively parallel machines and
on workstation clusters. More information on MPI can be found at
<FONT COLOR="#0000ff"><U><A HREF="http://www-unix.mcs.anl.gov/mpi">http://www-unix.mcs.anl.gov/mpi</A></U></FONT>.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">PAPI supports MPI.
When using timers in applications that contain multiplexing,
profiling, and overflow, MPI uses a default virtual timer and must be
converted to a real timer in order to for the application to work
properly. Otherwise, the application will exit.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Optionally, the
supported tools, <FONT COLOR="#0000ff"><U><A HREF="http://www.cs.uoregon.edu/research/paracomp/proj/tau">TAU</A></U></FONT>
and <FONT COLOR="#0000ff"><U><A HREF="http://www-pablo.cs.uiuc.edu/Project/SVPablo/SvPabloOverview.htm">SvPablo</A></U></FONT>,
can be used to implement PAPI with MPI.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The following is a
code example of using MPI’s <FONT COLOR="#0000ff"><U><A HREF="http://www-unix.mcs.anl.gov/mpi/tutorial/gropp/node57.html">PI
program</A></U></FONT> with PAPI:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;mpi.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;math.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;stdio.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
main(argc,argv)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
argc;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>char
*argv[];</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>int
done = 0, n, myid, numprocs, i, rc, retval, EventSet = PAPI_NULL;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>double
PI25DT = 3.141592653589793238462643;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>double
mypi, pi, h, sum, x, a;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>long_long
values[1] = {(long_long) 0};</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>MPI_Init(&amp;argc,&amp;argv);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"> 
<FONT FACE="Courier New, monospace"><FONT SIZE=2>MPI_Comm_size(MPI_COMM_WORLD,&amp;numprocs);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>MPI_Comm_rank(MPI_COMM_WORLD,&amp;myid);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>/*Initialize
the PAPI library */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= PAPI_library_init(PAPI_VER_CURRENT);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(retval != PAPI_VER_CURRENT) {</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stderr,
&quot;PAPI library init error!\n&quot;);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Create an EventSet */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_create_eventset(&amp;EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Add Total Instructions Executed to our EventSet */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_add_event(EventSet, PAPI_TOT_INS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Start counting */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_start(EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>while
(!done)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(myid == 0) {</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">        <FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;Enter
the number of intervals: (0 quits) &quot;);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">        <FONT FACE="Courier New, monospace"><FONT SIZE=2>scanf(&quot;%d&quot;,&amp;n);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>MPI_Bcast(&amp;n,
1, MPI_INT, 0, MPI_COMM_WORLD);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(n == 0) break;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>h
  = 1.0 / (double) n;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>sum
= 0.0;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>for
(i = myid + 1; i &lt;= n; i += numprocs) {</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">        <FONT FACE="Courier New, monospace"><FONT SIZE=2>x
= h * ((double)i - 0.5);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">        <FONT FACE="Courier New, monospace"><FONT SIZE=2>sum
+= 4.0 / (1.0 + x*x);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>mypi
= h * sum;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>MPI_Reduce(&amp;mypi,
&amp;pi, 1, MPI_DOUBLE, MPI_SUM, 0,MPI_COMM_WORLD);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(myid == 0)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">        <FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;pi
is approximately %.16f, Error is %.16f\n&quot;,</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">               <FONT FACE="Courier New, monospace"><FONT SIZE=2>pi,
fabs(pi - PI25DT));</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Read the counters */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_read(EventSet, values) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">     <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;After
reading counters: %lld\n&quot;,values[0]);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Start the counters */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_stop(EventSet, values) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">     <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>printf(&quot;After
stopping counters: %lld\n&quot;,values[0]);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">   <FONT FACE="Courier New, monospace"><FONT SIZE=2>MPI_Finalize();</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}<BR></FONT></FONT><BR>
</P>
<P STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H4 CLASS="western">POSSIBLE OUTPUT (AFTER ENTERING 50, 75, AND 100
AS INPUT):</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Enter
the number of intervals: (0 quits) 50</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>pi
is approximately 3.1416259869230028, Error is 0.0000333333332097</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Enter
the number of intervals: (0 quits) 75</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>pi
is approximately 3.1416074684045965, Error is 0.0000148148148034</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Enter
the number of intervals: (0 quits) 100</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>pi
is approximately 3.1416009869231254, Error is 0.0000083333333323</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Enter
the number of intervals: (0 quits) 0</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>After
reading counters: 117393</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>After
stopping counters: 122921</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H2 CLASS="western"><A NAME="OVERFLOW"></A><A NAME="10.4.OVERFLOW|outline"></A>
OVERFLOW</H2>
<H3 CLASS="western"><A NAME="WHAT_IS_OVERFLOW"></A><A NAME="10.4.1.WHAT IS AN OVERFLOW_|outline"></A>
WHAT IS AN OVERFLOW?</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">An overflow happens
when the number of occurrences of a particular hardware event exceeds
a specified threshold. PAPI provides the ability to call user-defined
handlers when an overflow occurs. This can be done in hardware, if
the processor generates an interrupt signal when the counter reaches
a specified value, or in software, by setting up a high-resolution
interval timer and installing a timer interrupt handler. For software
based overflow, PAPI compares the current counter value against the
threshold every time the timer interrupt occurs. If the current value
exceeds the threshold, then the user’s handler is called from
within the signal context with some additional arguments. These
arguments allow the user to determine which event overflowed, by how
much it overflowed, and at what location in the source code the
overflow occurred.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Using the same
mechanism as for user programmable overflow, PAPI also guards against
register precision overflow of counter values. Each counter can
potentially be incremented multiple times in a single clock cycle.
This fact combined with increasing clock speeds and the small dynamic
range of some of the physical counters means that an overflow is
likely to occur on platforms where 64-bit counters are not supported
in hardware or by the operating system. In those cases, the PAPI
implements 64-bit counters in software using the same mechanism that
handles overflow dispatch. 
</P>
<H3 CLASS="western"><A NAME="BEGINNING_OVERFLOWS"></A><A NAME="_BEGINNING_OVERFLOWS_IN"></A><A NAME="10.4.2.BEGINNING OVERFLOWS IN EVENT SETS|outline"></A>
BEGINNING OVERFLOWS IN EVENT SETS</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">An event set can
begin registering overflows by calling the following low-level
function:</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_overflow(<I>EventSet,
EventCode, threshold, flags, handler</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western">ARGUMENTS</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>EventSet</I>
<FONT FACE="Verdana, sans-serif">-- a reference to the event set to
use </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>EventCode</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- the event to be used for
overflow detection </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>threshold</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- the overflow threshold
value to use </FONT></FONT>
</P>
<P STYLE="margin-left: 0.38in; text-indent: -0.38in; margin-bottom: 0in">
<FONT FACE="Courier New, monospace"><I>flags</I><FONT FACE="Verdana, sans-serif">
-- bit map that controls the overflow mode of operation. The only
currently valid setting is </FONT><FONT SIZE=2>PAPI_OVERFLOW_FORCE_SW<FONT FACE="Verdana, sans-serif">,
</FONT></FONT><FONT FACE="Verdana, sans-serif">which<FONT SIZE=2>
</FONT>overrides the default hardware overflow setting on a platform
that supports hardware overflow.</FONT></FONT></P>
<P STYLE="margin-left: 0.38in; text-indent: -0.38in; margin-bottom: 0in">
<FONT FACE="Courier New, monospace"><I>handler</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- the handler function to
call upon overflow </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">This function marks
a specific <I><FONT FACE="Courier New, monospace">EventCode</FONT> </I>in
an <I><FONT FACE="Courier New, monospace">EventSet</FONT> </I>to
generate an overflow signal after every threshold events are counted.
Mutiple events within an event set can be programmed to overflow by
making successive calls to this function, but only a single overflow
handler can be registered. To turn off overflow for a specific event,
call <FONT FACE="Courier New, monospace">PAPI_overflow</FONT> with
<FONT FACE="Courier New, monospace">EventCode</FONT> set to the
desired event and <FONT FACE="Courier New, monospace">threshold</FONT>
set to zero.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The handler function
is a user-supplied callback routine that performs whatever special
processing needed to handle the overflow interrupt, including sorting
multiple overflowing events from each other. It must conform to the
following prototype:</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_overflow_handler(<I>EventSet,
address, overflow_vector, void *context</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><B>	</B></FONT></P>
<H4 CLASS="western">ARGUMENTS</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>EventSet</I>
<FONT FACE="Verdana, sans-serif">-- a reference to the event set in
use </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>address</I>
<FONT FACE="Verdana, sans-serif">– the address of the program
counter when the overflow occurred </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>overflow_vector</I>
<FONT FACE="Verdana, sans-serif">– a 64-bit vector that specifies
which counter(s) generated the overflow. Bit 0 corresponds to counter
0. The handler should be able to deal with multiple overflow bits per
call if more than one event may be set to overflow.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>context</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- a platform dependent
structure containing information about the state of the machine when
the overflow occurred. This structure is provided for completeness,
but can generally be ignored by most users.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In the following
code example, <FONT FACE="Courier New, monospace">PAPI_overflow</FONT>
is used to mark <FONT FACE="Courier New, monospace">PAPI_TOT_INS</FONT>
in order to generate an overflow signal after every 100,000 counted
events:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;stdio.h&gt;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#define
THRESHOLD  100000</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
total = 0;      /* total overflows */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>void
handler(int EventSet, void *address, long_long overflow_vector, void
*context)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stderr,
&quot;handler(%d) Overflow at %p! vector=0x%llx\n&quot;,<BR>   
EventSet, address, overflow_vector);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>	total++;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>	int
retval, EventSet = PAPI_NULL;</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>	/*
Initialize the PAPI library */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>	retval
= PAPI_library_init(PAPI_VER_CURRENT);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>	if
(retval != PAPI_VER_CURRENT)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>	
  handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>	/*
Create the EventSet */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>	if
(PAPI_create_eventset(&amp;EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>	
  handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>	/*
Add Total Instructions Executed to our EventSet */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>	if
(PAPI_add_event(EventSet, PAPI_TOT_INS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>	
  handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>	/*
Call handler every 100000 instructions */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>	retval
= PAPI_overflow(EventSet, PAPI_TOT_INS, THRESHOLD, 0, handler);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>	if
(retval != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>	
  handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>	/*
Start counting */</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>	if
(PAPI_start(EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>	
  handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">On success, this function returns
<FONT FACE="Courier New, monospace">PAPI_OK</FONT> and on error, a
non-zero error code is returned.</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in">For more code examples, see
<FONT FACE="Courier New, monospace">ctests/overflow.c,
ctests/overflow_twoevents.c</FONT><FONT FACE="Times New Roman, serif">
or </FONT><FONT FACE="Courier New, monospace">ctests/overflow_pthreads.c</FONT>
in the papi source distribution.</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H2 CLASS="western"><A NAME="STATISICAL_PROFILING"></A><A NAME="10.5.STATISTICAL PROFILING|outline"></A>
STATISTICAL PROFILING</H2>
<H3 CLASS="western"><A NAME="WHAT_IS_STATISICAL_PROFILING"></A><A NAME="10.5.1.WHAT IS STATISTICAL PROFILING_|outline"></A>
WHAT IS STATISTICAL PROFILING?</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Statistical
Profiling involves periodically interrupting a running program and
examining the program counter at the time of the interrupt. If this
is done for a reasonable number of interrupting intervals, the
resulting program counter distribution will be statistically
representative of the execution profile of the program with respect
to the interrupting event. Performance tools like UNIX prof sample
the program address with respect to time and hash the value into a
histogram. At program completion, the histogram is analyzed and
associated with symbolic information contained in the executable. GNU
prof in conjunction with the –p option of the GCC compiler performs
exactly this analysis using the process time as the interrupting
trigger. PAPI aims to generalize this functionality so that a
histogram can be generated using any countable hardware event as the
basis for the interrupt signal. 
</P>
<H3 CLASS="western"><A NAME="GENERATING_HISTOGRAM"></A><A NAME="10.5.2.GENERATING A PC HISTOGRAM|outline"></A>
GENERATING A PC HISTOGRAM</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">A PC histogram can
be generated on any countable event by calling either of the
following low-level functions:</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_profil(<I>buf,
bufsiz, offset, scale, EventSet, EventCode, threshold, flags</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_sprofil(<I>prof,
profcnt, EventSet, EventCode, threshold, flags</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>Fortran:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_profil(<I>buf,
bufsiz, offset, scale, EventSet, EventCode, threshold, flags</I>,
check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western">AGRUMENTS</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>*buf</I>
<FONT FACE="Verdana, sans-serif">-- pointer to profile buffer array. </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>bufsiz</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- number of entries in *buf.
</FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>offset</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- starting value of lowest
memory address to profile. </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>scale</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- scaling factor for bin
values. </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>EventSet</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- The PAPI EventSet to
profile when it is started. </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>EventCode</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- code of the Event in the
EventSet to profile. </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>threshold</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- threshold value for the
Event triggers the handler. </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>flags</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- bit pattern to control
profiling behavior. The defined bit values for the flags variable are
shown in the table below:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<CENTER>
	<TABLE WIDTH=675 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=7 CELLSPACING=0>
		<COL WIDTH=268>
		<COL WIDTH=377>
		<TR VALIGN=TOP>
			<TD WIDTH=268 BGCOLOR="#cccccc">
				<P ALIGN=CENTER STYLE="margin-right: 0.5in">Defined bit</P>
			</TD>
			<TD WIDTH=377 BGCOLOR="#cccccc">
				<P ALIGN=CENTER STYLE="margin-right: 0.5in">Description</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=268 BGCOLOR="#cccccc">
				<P STYLE="margin-right: 0.5in"><FONT FACE="Courier New, monospace">PAPI_PROFIL_POSIX</FONT></P>
			</TD>
			<TD WIDTH=377 BGCOLOR="#cccccc">
				<P STYLE="margin-right: 0.5in">Default type of profiling.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=268 BGCOLOR="#cccccc">
				<P STYLE="margin-right: 0.5in"><FONT FACE="Courier New, monospace">PAPI_PROFIL_RANDOM</FONT></P>
			</TD>
			<TD WIDTH=377 BGCOLOR="#cccccc">
				<P STYLE="margin-right: 0.5in">Drop a random 25% of the samples.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=268 BGCOLOR="#cccccc">
				<P STYLE="margin-right: 0.5in"><FONT FACE="Courier New, monospace">PAPI_PROFIL_WEIGHTED</FONT></P>
			</TD>
			<TD WIDTH=377 BGCOLOR="#cccccc">
				<P STYLE="margin-right: 0.5in">Weight the samples by their value.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=268 BGCOLOR="#cccccc">
				<P STYLE="margin-right: 0.5in"><FONT FACE="Courier New, monospace">PAPI_PROFIL_COMPRESS</FONT></P>
			</TD>
			<TD WIDTH=377 BGCOLOR="#cccccc">
				<P STYLE="margin-right: 0.5in">Ignore samples if hash buckets get
				big.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=268 BGCOLOR="#cccccc">
				<P STYLE="margin-right: 0.5in"><FONT FACE="Courier New, monospace">PAPI_PROFIL_BUCKET_16</FONT></P>
			</TD>
			<TD WIDTH=377 BGCOLOR="#cccccc">
				<P STYLE="margin-right: 0.5in">Save samples in 16-bit hash
				buckets.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=268 BGCOLOR="#cccccc">
				<P STYLE="margin-right: 0.5in"><FONT FACE="Courier New, monospace">PAPI_PROFIL_BUCKET_32</FONT></P>
			</TD>
			<TD WIDTH=377 BGCOLOR="#cccccc">
				<P STYLE="margin-right: 0.5in">Save samples in 32-bit hash
				buckets.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=268 BGCOLOR="#cccccc">
				<P STYLE="margin-right: 0.5in"><FONT FACE="Courier New, monospace">PAPI_PROFIL_BUCKET_64</FONT></P>
			</TD>
			<TD WIDTH=377 BGCOLOR="#cccccc">
				<P STYLE="margin-right: 0.5in">Save samples in 64-bit hash
				buckets.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=268 BGCOLOR="#cccccc">
				<P STYLE="margin-right: 0.5in"><FONT FACE="Courier New, monospace">PAPI_PROFIL_FORCE_SW</FONT></P>
			</TD>
			<TD WIDTH=377 BGCOLOR="#cccccc">
				<P STYLE="margin-right: 0.5in"><FONT COLOR="#000000">Force
				software overflow in profiling.</FONT></P>
			</TD>
		</TR>
	</TABLE>
</CENTER>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>*prof</I>
<FONT FACE="Verdana, sans-serif">-- pointer to </FONT>PAPI_sprofil_t<FONT FACE="Verdana, sans-serif">
structure. </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>profcnt</I>
<FONT FACE="Verdana, sans-serif">-- number of buffers for hardware
profiling (<B>reserved</B>).</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_profil</FONT>
creates a histogram of overflow counts for a specified region of the
application code by using its first four parameters to create the
data structures needed by <FONT FACE="Courier New, monospace">PAPI_sprofil</FONT>
and then calls <FONT FACE="Courier New, monospace">PAPI_sprofil</FONT>
to do the work. <FONT FACE="Courier New, monospace">PAPI_sprofil</FONT>
assumes a pre-initialized <FONT FACE="Courier New, monospace">PAPI_sprofil_t</FONT>
structure and enables profiling for the <I><FONT FACE="Courier New, monospace">EventSet</FONT></I>
based on its value. <B>Note that the <FONT FACE="Courier New, monospace">EventSet</FONT>
must be in the stopped state in order for either call to succeed.</B>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">More than one
hardware event can be profiled at the same time by making multiple
independent calls to these functions for the same <FONT FACE="Courier New, monospace">EventSet</FONT>
before calling <FONT FACE="Courier New, monospace">PAPI_start</FONT>.
This can be useful for the simultaneous generation of profiles of two
or more related events, for example L1 cache misses and L2 cache
misses. Profiling can be turned off for specific events by calling
the function for that event with a <FONT FACE="Courier New, monospace">threshold</FONT>
of zero.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">On success, these
functions return <FONT FACE="Courier New, monospace">PAPI_OK</FONT>
and on error, a non-zero error code is returned.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">For more code
examples, see <FONT FACE="Courier New, monospace">profile.c,
profile_twoevents.c </FONT>or<FONT FACE="Courier New, monospace">
sprofile.c </FONT>in the<FONT FACE="Courier New, monospace"> ctests</FONT>
directory of the PAPI source distribution.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">For a more extensive
description of the parameters in the <FONT FACE="Courier New, monospace">PAPI_profil</FONT>
call, see the <FONT FACE="Courier New, monospace">PAPI_profil</FONT>
man page or its html counterpart
at:<BR><FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/projects/papi/files/html_man3/papi_profil.html%0D">http://icl.cs.utk.edu/projects/papi/files/html_man3/papi_profil.html</A></U></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In the following
code example, <FONT FACE="Courier New, monospace">PAPI_profil</FONT>
is used to generate a PC histogram:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT SIZE=3><FONT FACE="Times New Roman, serif">#include
&lt;papi.h&gt;</FONT></FONT></FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT SIZE=3><FONT FACE="Times New Roman, serif">#include
&lt;stdio.h&gt;</FONT></FONT></FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT SIZE=3><FONT FACE="Times New Roman, serif">main()</FONT></FONT></FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT SIZE=3><FONT FACE="Times New Roman, serif">{</FONT></FONT></FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT SIZE=3><FONT FACE="Times New Roman, serif">int
retval;</FONT></FONT></FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT SIZE=3><FONT FACE="Times New Roman, serif">int
EventSet = PAPI_NULL;</FONT></FONT></FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT SIZE=3><FONT FACE="Times New Roman, serif">unsigned
long start, end, length;</FONT></FONT></FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT SIZE=3><FONT FACE="Times New Roman, serif">PAPI_exe_info_t
*prginfo;</FONT></FONT></FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT SIZE=3><FONT FACE="Times New Roman, serif">unsigned
short *profbuf;</FONT></FONT></FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Initialize the PAPI library */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= PAPI_library_init(PAPI_VER_CURRENT);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(retval != PAPI_VER_CURRENT &amp; retval &gt; 0) {</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"> 
<FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stderr,&quot;PAPI
library version mismatch!0);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(retval &lt; 0)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"> 
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(retval);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
((prginfo = PAPI_get_executable_info()) == NULL)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>start
= (unsigned long)prginfo-&gt;text_start;</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>end
= (unsigned long)prginfo-&gt;text_end;</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>length
= end - start;</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>profbuf
= (unsigned short *)malloc(length*sizeof(unsigned short));</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(profbuf == NULL)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>memset(profbuf,0x00,length*sizeof(unsigned
short));</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_create_eventset(&amp;EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"> 
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(retval);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Add Total FP Instructions Executed to our EventSet */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_add_event(EventSet, PAPI_FP_INS) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"> 
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(retval);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(PAPI_profil(profbuf, length, start, 65536, EventSet, PAPI_FP_INS,
1000000, PAPI_PROFIL_POSIX | PAPI_PROFIL_BUCKET_16) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Start counting */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">if
(PAPI_start(EventSet) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt">handle_error(1);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-right: 0.5in; margin-bottom: 0in"><BR>
</P>
<H2 CLASS="western"><A NAME="10.6.DATA AND INSTRUCTION ADDRESS RESTRICTION|outline"></A>
DATA AND INSTRUCTION ADDRESS RESTRICTION</H2>
<H3 CLASS="western"><A NAME="10.6.1.Introduction|outline"></A>Introduction</H3>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in">Performance
instrumentation of data structures, as opposed to code segments, is a
feature not widely supported across a range of platforms. One
platform on which this feature is supported is the Itanium2. In fact,
event counting on Itanium2 can be qualified by a number of
conditioners, including instruction address, opcode matching, and
data address. We have implemented a generalized PAPI interface for
data structure and instruction range performance instrumentation,
also referred to as data and instruction range specification, and
applied that interface to the specific instance of the Itanium2
platform to demonstrate its viability. This feature is being
introduced for the first time in the PAPI 3.5 release. 
</P>
<H3 CLASS="western"><A NAME="10.6.2.The PAPI Interface|outline"></A>The
PAPI Interface</H3>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in">Since PAPI is a
platform-independent library, care must be taken when extending its
feature set so as not to disrupt the existing interface or to clutter
the API with calls to functionality that is not available on a large
subset of the supported platforms. To that end, we elected to extend
an existing PAPI call, <FONT FACE="Courier New, monospace">PAPI_set_opt()</FONT>,
with the capability of specifying starting and ending addresses of
data structures or instructions to be instrumented. The
<FONT FACE="Courier New, monospace">PAPI_set_opt()</FONT> call
previously supported functionality to set a variety of optional
capability in the PAPI interface, including debug levels,
multiplexing of eventsets,  and the scope of counting domains. This
call was extended with two new cases to support instruction and data
address range specification: <FONT FACE="Courier New, monospace">PAPI_INSTR_ADDRESS
</FONT>and<FONT FACE="Courier New, monospace"> PAPI_DATA_ADDRESS</FONT>.
To access these options, a user initializes a simple option specific
data structure and calls <FONT FACE="Courier New, monospace">PAPI_set_opt()</FONT>
as illustrated in the code fragment below:</P>
<P CLASS="western" STYLE="margin-top: 0.19in; margin-bottom: 0.19in">
  <FONT FACE="Courier New, monospace">...<BR>   option.addr.eventset
= EventSet; </FONT><BR><FONT FACE="Courier New, monospace">&nbsp;&nbsp;
option.addr.start = (caddr_t)array; </FONT><BR><FONT FACE="Courier New, monospace">
  option.addr.end = (caddr_t)(array + size_array); </FONT><BR><FONT FACE="Courier New, monospace">
  retval = PAPI_set_opt(PAPI_DATA_ADDRESS, &amp;option);<BR>&nbsp;&nbsp;
...</FONT></P>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in">The user creates
a PAPI eventset and determines the starting and ending addresses of
the data to be monitored. The call to <FONT FACE="Courier New, monospace">PAPI_set_opt</FONT>
then prepares the interface to count events that occur on accesses to
data in that range. The specific events to be monitored can be added
to the eventset either before or after the data range is specified.
In a similar fashion, an instruction range can be set using the
<FONT FACE="Courier New, monospace">PAPI_INSTR_ADDRESS </FONT>option.
If this option is supported on the platform in use, the data is
transferred to the platform-specific implementation and handled
appropriately. If not supported, the call returns an error message.</P>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in">It may not
always be possible to exactly specify the address range of interest.
If this is the case, it is important that the user have some way to
know what approximations have been made, so that appropriate
corrective action&nbsp;can be taken. For instance, to isolate a
specific data structure completely, it may be necessary to pad memory
before and after the structure with dummy structures that are never
accessed. To facilitate this, <FONT FACE="Courier New, monospace">PAPI_set_opt()</FONT>
returns the offsets from the requested starting and ending addresses
as they were actually programmed into the hardware. If the addresses
were mapped exactly, these values are zero. An example of this is
shown below:</P>
<P CLASS="western" STYLE="margin-top: 0.19in; margin-bottom: 0.19in">
  <FONT FACE="Courier New, monospace">...<BR>   retval =
PAPI_set_opt(PAPI_DATA_ADDRESS, &amp;option);<BR>&nbsp;&nbsp;
actual.start = (caddr_t)array - option.addr.start_off; <BR>  
actual.end = (caddr_t)(array + size_array) + option.addr.end_off; <BR>&nbsp;&nbsp;
...</FONT></P>
<H3 CLASS="western"><A NAME="10.6.3.Itanium Idiosyncrasies|outline"></A>
Itanium Idiosyncrasies</H3>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in">There are
roughly 475 native events available on Itanium 2.160 of them are
memory related and can be counted with data address specification in
place. 283 can be counted using instruction address specification.
All events in an eventset with data or instruction range
specification in place must be one of these supported events. Further
restrictions also apply to the use of data and instruction range
specification, as described below. Data addresses can only be
specified in coarse mode. Although four independent pairs of data
address registers exist in the hardware and would suggest that four
disjoint address regions can be monitored simultaneously, the Intel
documentation strongly suggests that this is not a good idea.
Further, the underlying software takes advantage of these register
pairs to tune the range of addresses that is actually monitored. See
the discussion under <STRONG>Data Address Ranges</STRONG> for further
detail.</P>
<H4 CLASS="western">Instruction Address Ranges</H4>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in">Instruction
ranges can be specified in one of two ways: coarse and fine. In fine
mode, addresses can be specified exactly, but both the start and end
addresses must exist on the same 4K byte page. In other words, the
address range must be less than 4K bytes, and the addresses can only
differ in the bottom 12 bits. If fine mode cannot be used, the
underlying perfmon library automatically switches to coarse address
specification. Four pairs of registers are available to specify
coarse instruction address ranges. The restrictions to coarse address
specification are discussed below.</P>
<H4 CLASS="western">Data Address Ranges</H4>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in">Data addresses
can only be specified in coarse mode. As with instruction ranges,
four pairs of registers are available to specify the data address
ranges. Use of coarse mode addressing for either instruction or data
address specification can cause some anomalous results. The Intel
documentation points out that starting and ending addresses cannot be
specified exactly, since the hardware representation relies on
powers-of-two bitmasks. The perfmon library tries to optimize the
alignment of these power-of-two regions to cover the addresses
requested as effectively as possible with the four sets of registers
available. Perfmon first finds the largest power-of-two address
region completely contained within the requested addresses. Then it
finds successively smaller power-of-two regions to cover the errors
on the high and low end of the requested address range. The effective
result is that the actual range specified is always equal to or
larger than, and completely contains the requested range, and can
occupy from one to four pairs of address registers. In some cases
this can result in significant overcounts of the events of interest,
especially if two active data structures are located in close
proximity to each other. This may require that the developer insert
some padding structures before and/or after a particular structure of
interest to guarantee accurate counts.</P>
<H3 CLASS="western"><A NAME="10.6.4.Supporting Software|outline"></A>Supporting
Software</H3>
<P CLASS="western" STYLE="margin-top: 0.19in; margin-bottom: 0.19in">To
make this new PAPI feature more accessible and easier to use, a test
case was developed to both provide a coding example and to exercise
and test the fuctionality of the data ranging features of the Itanium
2. In addition, the papi_native_event utility was modified to make it
easier to identify events that support these features.</P>
<H3 CLASS="western"><A NAME="10.6.5.The data_range.c Test Case|outline"></A>
The <FONT FACE="Courier New, monospace">data_range.c</FONT> Test Case</H3>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in">A test case,
called <FONT FACE="Courier New, monospace">data_range</FONT> was
developed that measures memory load and store events on three
different types of data structures. Three static arrays of 16,384
<EM>ints</EM> were declared in the program, and three dynamic arrays
of 16,384 <EM>ints </EM>were malloc'd. The data range was specified
sequentially to be the starting and ending addresses of each of:</P>
<UL>
	<LI><P CLASS="western" STYLE="margin-top: 0.19in; margin-bottom: 0in">
	the pointers to the malloc'd arrays;</P>
	<LI><P CLASS="western" STYLE="margin-bottom: 0in">the malloc'd
	arrays themselves;</P>
	<LI><P CLASS="western" STYLE="margin-bottom: 0.19in">the statically
	declared arrays.</P>
</UL>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in">The work done in
each case consisted of loading an initialization value into each
element of each array, and then summing the values of each element.
This should produce 16,384 loads and 16,384 stores on each element.</P>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in">For the
pointers, the size was 8 bytes and the starting and ending addresses
could be specified exactly. Output is shown below:</P>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">Measure
loads and stores on the pointers to the allocated arrays <BR>Expected
loads: 32768; Expected stores: 0 <BR>These loads result from
accessing the pointers to compute array addresses. <BR>They will
likely disappear with higher levels of optimization. <BR>Requested
Start Address: 0x6000000000011640; Start Offset: 0x 0; Actual Start
Address: 0x6000000000011640 <BR>Requested End Address:
0x6000000000011648; End Offset: 0x 0; Actual End Address:
0x6000000000011648 <BR>loads_retired: 32768 <BR>stores_retired: 0
<BR>Requested Start Address: 0x6000000000011628; Start Offset: 0x 0;
Actual Start Address: 0x6000000000011628 <BR>Requested End Address:
0x6000000000011630; End Offset: 0x 0; Actual End Address:
0x6000000000011630 <BR>loads_retired: 32768 <BR>stores_retired: 0
<BR>Requested Start Address: 0x6000000000011638; Start Offset: 0x 0;
Actual Start Address: 0x6000000000011638 <BR>Requested End Address:
0x6000000000011640; End Offset: 0x 0; Actual End Address:
0x6000000000011640 <BR>loads_retired: 32768 <BR>stores_retired: 0 </FONT>
</P>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in">For the
allocated arrays, small offsets were introduced in each case, and the
resulting error in the loads and stores is exactly what would be
predicted by the activity in the adjacent memory locations:</P>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">Measure
loads and stores on the allocated arrays themselves <BR>Expected
loads: 16384; Expected stores: 16384 <BR>Requested Start Address:
0x6000000004044010; Start Offset: 0x 10; Actual Start Address:
0x6000000004044000 <BR>Requested End Address: 0x6000000004054010; End
Offset: 0x 0; Actual End Address: 0x6000000004054010 <BR>loads_retired:
16384 <BR>stores_retired: 16384 <BR>Requested Start Address:
0x6000000004054020; Start Offset: 0x 20; Actual Start Address:
0x6000000004054000 <BR>Requested End Address: 0x6000000004064020; End
Offset: 0x 0; Actual End Address: 0x6000000004064020 <BR>loads_retired:
16388 <BR>stores_retired: 16388 <BR>Requested Start Address:
0x6000000004064030; Start Offset: 0x 30; Actual Start Address:
0x6000000004064000 <BR>Requested End Address: 0x6000000004074030; End
Offset: 0x 10; Actual End Address: 0x6000000004074040 <BR>loads_retired:
16392 <BR>stores_retired: 16392 </FONT>
</P>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in">For the static
arrays, the locations of the arrays resulted in significant offsets,
and hence significant errors. The most interesting case is the second
one, in which the starting offset can be seen to force the inclusion
of all three pointers to the malloc'd arrays. Because of this the
loads retired count is too high by 98310, almost exactly 3 * 32768 =
98204:</P>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">Measure
loads and stores on the static arrays <BR>These values will differ
from the expected values by the size of the offsets. <BR>Expected
loads: 16384; Expected stores: 16384 <BR>Requested Start Address:
0x60000000000218cc; Start Offset: 0x 18cc; Actual Start Address:
0x6000000000020000 <BR>Requested End Address: 0x60000000000318cc; End
Offset: 0x 734; Actual End Address: 0x6000000000032000
<BR>loads_retired: 18432 <BR>stores_retired: 18432 <BR>Requested
Start Address: 0x60000000000118cc; Start Offset: 0x 18cc; Actual
Start Address: 0x6000000000010000 <BR>Requested End Address:
0x60000000000218cc; End Offset: 0x 734; Actual End Address:
0x6000000000022000 <BR>loads_retired: 115155 <BR>stores_retired:
16845 <BR>Requested Start Address: 0x60000000000318cc; Start Offset:
0x 18cc; Actual Start Address: 0x6000000000030000 <BR>Requested End
Address: 0x60000000000418cc; End Offset: 0x 734; Actual End Address:
0x6000000000042000 <BR>loads_retired: 17971 <BR>stores_retired: 17971
</FONT>
</P>
<H3 CLASS="western"><A NAME="10.6.6.The papi_native_avail Utility|outline"></A>
The papi_native_avail Utility</H3>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in">To effectively
use the instruction and address range specification feature for
Itanium 2, one must know which of the roughly 475 available native
events support these features. In addition, there are other
qualifiers to Itanium 2 native events that are valuable to inspect.
For these reasons, the <FONT FACE="Courier New, monospace">papi_native_avail</FONT>
utility was enhanced to make it possible to filter the list of native
events by these qualifiers. A help feature was added to this utility
to make it easier to remember the Itanium specific options:</P>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">&gt;
papi_native_avail --help <BR>This is the PAPI native avail program.
<BR>It provides availability and detail information <BR>for PAPI
native events. Usage: <BR>&nbsp;&nbsp;&nbsp; papi_native_avail
[options] <BR>Options: <BR><BR>&nbsp; -h, --help&nbsp; print this
help message <BR>&nbsp; --darr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; display
Itanium events that support Data Address Range Restriction <BR>&nbsp;
--dear&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; display Itanium Data Event
Address Register events only <BR>&nbsp; --iarr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
display Itanium events that support Instruction Address Range
Restriction <BR>&nbsp; --iear&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; display
Itanium Instruction Event Address Register events only <BR>&nbsp;
--opcm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; display Itanium events that
support OpCode Matching <BR>&nbsp; NOTE:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
The last five options are mutually exclusive.</FONT></P>
<P STYLE="margin-top: 0.19in; margin-bottom: 0.19in">If any of these
options are specified on the command line, only those events that
support that option are displayed. Even so, the list can be
extensive, with roughly 160 events supporting data address ranging,
and even more supporting instruction address ranging.</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="PAPI_ERROR_HANDLING"></A><A NAME="11.PAPI ERROR HANDLING	|outline"></A>
PAPI ERROR HANDLING	</H1>
<H2 CLASS="western"><A NAME="ERROR_CODES"></A><A NAME="11.1.ERROR CODES|outline"></A>
ERROR CODES</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">All of the functions
contained in the PAPI library return standardized error codes in
which the values that are greater than or equal to zero indicate
success and those that are less than zero indicate failure, as shown
in the table below:</P>
<TABLE WIDTH=680 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=7 CELLSPACING=0>
	<COL WIDTH=60>
	<COL WIDTH=144>
	<COL WIDTH=431>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<H4 CLASS="western">VALUE</H4>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<H4 CLASS="western">SYMBOL</H4>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<H4 CLASS="western">DEFINITION</H4>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<P CLASS="western">0</P>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<P CLASS="western"><FONT FACE="Courier New, monospace">PAPI_OK</FONT></P>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<P CLASS="western">No error</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<P CLASS="western">-1</P>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<P CLASS="western"><FONT FACE="Courier New, monospace">PAPI_EINVAL</FONT></P>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<P CLASS="western">Invalid argument</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<P CLASS="western">-2</P>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<P CLASS="western"><FONT FACE="Courier New, monospace">PAPI_ENOMEM</FONT></P>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<P CLASS="western">Insufficient memory</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<P CLASS="western">-3</P>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<P CLASS="western"><FONT FACE="Courier New, monospace">PAPI_ESYS</FONT></P>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<P CLASS="western">A system or C library call failed, please check
			<I>errno</I></P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<P CLASS="western">-4</P>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<P CLASS="western"><FONT FACE="Courier New, monospace">PAPI_ESBSTR</FONT></P>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<P CLASS="western">Substrate returned an error, usually the result
			of an unimplemented feature</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<P CLASS="western">-5</P>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<P CLASS="western"><FONT FACE="Courier New, monospace">PAPI_ECLOST</FONT></P>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<P CLASS="western">Access to the counters was lost or interrupted</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<P CLASS="western">-6</P>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<P CLASS="western"><FONT FACE="Courier New, monospace">PAPI_EBUG</FONT></P>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<P CLASS="western">Internal error, please send mail to the
			developers</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<P CLASS="western">-7</P>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<P CLASS="western"><FONT FACE="Courier New, monospace">PAPI_ENOEVNT</FONT></P>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<P CLASS="western">Hardware event does not exist</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<P CLASS="western">-8</P>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<P CLASS="western"><FONT FACE="Courier New, monospace">PAPI_ECNFLCT</FONT></P>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<P CLASS="western">Hardware event exists, but cannot be counted
			due to counter resource limitations</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<P CLASS="western">-9</P>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<P CLASS="western"><FONT FACE="Courier New, monospace">PAPI_ENOTRUN</FONT></P>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<P CLASS="western">No events or event sets are currently not
			counting</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<P CLASS="western">-10</P>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<P CLASS="western"><FONT FACE="Courier New, monospace">PAPI_EISRUN</FONT></P>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<P CLASS="western">Event Set is currently running</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<P CLASS="western">-11</P>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<P CLASS="western"><FONT FACE="Courier New, monospace">PAPI_ENOEVST</FONT></P>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<P CLASS="western">No such event set available</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<P CLASS="western">-12</P>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<P CLASS="western"><FONT FACE="Courier New, monospace">PAPI_ENOTPRESET</FONT></P>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<P CLASS="western">Event is not a valid preset</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<P CLASS="western">-13</P>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<P CLASS="western"><FONT FACE="Courier New, monospace">PAPI_ENOCNTR</FONT></P>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<P CLASS="western">Hardware does not support performance counters</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<P CLASS="western">-14</P>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<P CLASS="western"><FONT FACE="Courier New, monospace">PAPI_EMISC</FONT></P>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<P CLASS="western">‘Unknown error’ code</P>
		</TD>
	</TR>
	<TR VALIGN=TOP>
		<TD WIDTH=60 BGCOLOR="#d9d9d9">
			<P CLASS="western">-15</P>
		</TD>
		<TD WIDTH=144 BGCOLOR="#d9d9d9">
			<P CLASS="western"><FONT FACE="Courier New, monospace">PAPI_EPERM</FONT></P>
		</TD>
		<TD WIDTH=431 BGCOLOR="#d9d9d9">
			<P CLASS="western">You lack the necessary permissions</P>
		</TD>
	</TR>
</TABLE>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H3 CLASS="western"><A NAME="CONVERTING_ERROR_CODES"></A><A NAME="11.1.1.CONVERTING ERROR CODES TO ERROR MESSAGES|outline"></A>
CONVERTING ERROR CODES TO ERROR MESSAGES</H3>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Error codes can be
converted to error messages by calling the following low-level
functions:</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>C:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_perror(<I>code,
destination, length</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPI_strerror(<I>code</I>)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>Fortan:</B></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace">PAPIF_perror(<I>code</I>,
<I>destination</I>, check)</FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<H4 CLASS="western">ARGUMENTS</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>code</I>
<FONT FACE="Verdana, sans-serif">-- the error code to interpret </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I><FONT FACE="Times New Roman, serif">*</FONT>destination</I><FONT FACE="Verdana, sans-serif">
-- &quot;the error message in quotes&quot;  </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><I>length</I><FONT FACE="Times New Roman, serif">
</FONT><FONT FACE="Verdana, sans-serif">-- either 0 or
</FONT>strlen(destination)<FONT FACE="Verdana, sans-serif"> </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_perror</FONT>
fills the string, <I><FONT FACE="Courier New, monospace">destination</FONT>,</I>
with the error message corresponding to the error code (<I>code)</I>.
The function copies <I><FONT FACE="Courier New, monospace">length</FONT></I>
worth of the error description string corresponding to <I>code</I>
into <I>destination</I>. The resulting string is always null
terminated. If <I><FONT FACE="Courier New, monospace">length</FONT></I>
is 0, then the string is printed to stderr.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><FONT FACE="Courier New, monospace">PAPI_strerror</FONT>
returns a pointer to the error message corresponding to the error
code (<I>code)</I>. If the call fails, the function returns a <FONT FACE="Courier New, monospace">NULL</FONT>
pointer. Otherwise, a non-<FONT FACE="Courier New, monospace">NULL</FONT>
pointer is returned. <B>Note that this function is not implemented in
Fortran.</B></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In the following
code example, <FONT FACE="Courier New, monospace">PAPI_perror</FONT>
is used to convert error codes to error messages:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;papi.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>#include
&lt;stdio.h&gt;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>main()</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>{</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
EventSet = PAPI_NULL;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>int
native = 0x0;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>char
error_str[PAPI_MAX_STR_LEN];</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Initialize the PAPI library */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= PAPI_library_init(PAPI_VER_CURRENT);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">&nbsp;</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
(retval != PAPI_VER_CURRENT &amp;&amp; retval &gt; 0) {</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"> 
<FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stderr,&quot;PAPI
library version mismatch!\n&quot;);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
((retval = PAPI_create_eventset(&amp;EventSet)) != PAPI_OK) {</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">    
<FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stderr,
&quot;PAPI error %d: %s\n&quot;,retval,<BR> 		PAPI_strerror(retval));</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">     <FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2>}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></FONT></FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Add Total Instructions Executed to our EventSet */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
((retval = PAPI_add_event(&amp;EventSet, PAPI_TOT_INS)) != PAPI_OK) {</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">    
<FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_perror(retval,error_str,PAPI_MAX_STR_LEN);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">    
<FONT FACE="Courier New, monospace"><FONT SIZE=2>fprintf(stderr,&quot;PAPI_error
%d: %s\n&quot;,retval,error_str);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">     <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Add POWER4 native event */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>retval
= PAPI_event_name_to_code(“PM_LD_MISS_L1”, &amp;native);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
((retval = PAPI_add_event(&amp;EventSet, native)) != PAPI_OK) {</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">     <FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Dump error string directly to stderr. */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">     
<FONT FACE="Courier New, monospace"><FONT SIZE=2>PAPI_perror(retval,NULL,NULL);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in">     <FONT FACE="Courier New, monospace"><FONT SIZE=2>exit(1);</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>/*
Start counting */</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>if
((retval = PAPI_start(EventSet)) != PAPI_OK)</FONT></FONT></P>
<P STYLE="margin-left: 0.33in; margin-bottom: 0in"> 
<FONT FACE="Courier New, monospace"><FONT SIZE=2>handle_error(retval);</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>}</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<H4 CLASS="western">OUTPUT:</H4>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>Invalid
argument</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><B>Notice that the
above output was generated from the last call to <FONT FACE="Courier New, monospace">PAPI_perror</FONT>.</B></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">On success,
<FONT FACE="Courier New, monospace">PAPI_perror</FONT> returns
<FONT FACE="Courier New, monospace">PAPI_OK</FONT> and on error, a
non-zero error code is returned.</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="12.FURTHER INFORMATION	|outline"></A>
FURTHER INFORMATION	</H1>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In addition to the
information in this Users Guide on Programming with PAPI, a number of
other information sources are available. Most of these are available
on the PAPI website. Below we list some of these resources and
indicate where they can be found.</P>
<H2 CLASS="western"><A NAME="12.1.PAPI HOME PAGE|outline"></A>PAPI
HOME PAGE</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">The PAPI Project
home page can be found at:<BR><FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/papi/">http://icl.cs.utk.edu/papi/</A></U></FONT></P>
<H2 CLASS="western"><A NAME="12.2.PAPI MAILING LISTS|outline"></A>PAPI
MAILING LISTS</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">PAPI has two mailing
lists for users and developers. For more information about the
mailing lists and to subscribe or modify your mailing list settings,
click the “Mailing &amp; User Lists” tab under “Contacts’ on
the PAPI web page, or go directly
to:<BR><FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/papi/custom/index.html?lid=50&amp;slid=67">http://icl.cs.utk.edu/papi/custom/index.html?lid=50&amp;slid=67</A></U></FONT></P>
<H2 CLASS="western"><A NAME="12.3.REPORTING BUGS|outline"></A>REPORTING
BUGS</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">If you find a bug in
PAPI, you can send mail to one of the mailing lists above, or peruse
the mail archives to see if it has been reported by anyone else. You
can also submit the bug directly to PAPIzilla, the PAPI bug tracking
website. To access PAPIzilla, click the “Bug Reporting” tab under
“Contacts’ on the PAPI web page, or go directly
to:<BR><FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/projects/papi/bugz/%0D">http://icl.cs.utk.edu/projects/papi/bugz/</A></U></FONT></P>
<H2 CLASS="western"><A NAME="12.4.PAPI PROGRAMMER’S REFERENCE|outline"></A>
PAPI PROGRAMMER’S REFERENCE</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Function by function
documentation for PAPI can be found in a number of formats.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">PAPI man pages are
part of the standard installation package. For a properly installed
PAPI, you should be able to display a man page for any PAPI function
by typing:</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Courier New, monospace"><FONT SIZE=2>&gt;
man PAPI_xxx</FONT></FONT></P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">where “<FONT FACE="Courier New, monospace">PAPI_xxx</FONT>”
is a PAPI function name.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">In addition, this
information is also available in HTML format on the PAPI website
at:<BR><FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/projects/papi/files/html_man3/papi.html">http://icl.cs.utk.edu/projects/papi/files/html_man3/papi.html</A></U></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">If you want a
printable version of the Programmer’s Reference, you can find it in
Word and PDF formats under the ‘Documentation’ tab on the PAPI
website.</P>
<H2 CLASS="western"><A NAME="12.5.TABLE OF PRESET EVENTS|outline"></A>
TABLE OF PRESET EVENTS</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">A table of present
events, their standard definitions, and the platforms on which they
are defined can be found
at:<BR><FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/projects/papi/presets.html">http://icl.cs.utk.edu/projects/papi/presets.html</A></U></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Note that tables
inevitably become outdated. Always use the <FONT FACE="Courier New, monospace">util/papi_avail</FONT>
utility for the most current definitions of preset events on your
platform.</P>
<H2 CLASS="western"><A NAME="APPENDIX_D"></A><A NAME="12.6.SUPPORTED PLATFORMS|outline"></A>
SUPPORTED PLATFORMS</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">A table of currently
supported hardware platforms and operating systems can be found on
the PAPI website under the “Supported Platforms” tab.</P>
<H2 CLASS="western"><A NAME="APPENDIX_J"></A><A NAME="12.7.SUPPORTED TOOLS|outline"></A>
SUPPORTED TOOLS</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">A list of tools that
support PAPI, along with a brief description of each tool and a link
to further information, can be found under the “Tools” tab on the
PAPI website.</P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">A second list of
tools that support PAPI, along with a list of links to related
projects and links to a variety of vendor documentation can be found
on the PAPI website under the “Links” tab.</P>
<H2 CLASS="western"><A NAME="12.8.HARDWARE REFERENCES|outline"></A>HARDWARE
REFERENCES</H2>
<P CLASS="western" STYLE="margin-bottom: 0.19in">A series of links to
vendor and third party hardware documentation on performance counter
resources can also be found on the PAPI website under the “Links”
tab.</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="BIBLIOGRAPHY"></A><A NAME="13.BIBLIOGRAPHY	|outline"></A>
BIBLIOGRAPHY	</H1>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Browne, S., J.
Dongarra J., Garner N., London K., and Mucci, P., &quot;A Portable
Programming Interface for Performance Evaluation on Modern
Processors,” University of Tennessee Technical Report, Knoxville,
Tennessee, July 2000. <FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/papi/documents">http://icl.cs.utk.edu/papi/documents</A></U></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Browne, S., Dongarra
J., Garner N., London K., and Mucci, P., &quot;A Scalable
Cross-Platform Infrastructure for Application Performance Tuning
Using Hardware Counters,” Proc. <I>SC'2000</I>, November 2000.
<FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/papi/documents">http://icl.cs.utk.edu/papi/documents</A></U></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Dongarra, J.,
London, K., Moore, S., Mucci, P., and Terpstra, D. &quot;Using PAPI
for Hardware Performance Monitoring on Linux Systems,” <I>Conference
on Linux Clusters: The HPC Revolution</I>, Urbana, Illinois, June
25-27, 2001. <FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/papi/documents">http://icl.cs.utk.edu/papi/documents</A></U></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">London, K., Moore,
S., Mucci, P., Seymour, K., and Luczak, R. &quot;The PAPI
Cross-Platform Interface to Hardware Performance Counters,”
Department of Defense Users' Group Conference Proceedings, Biloxi,
Mississippi, June 18-21, 2001. <FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/papi/documents">http://icl.cs.utk.edu/papi/documens</A></U></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">London, K.,
Dongarra, J., Moore, S., Mucci, P., Seymour, K., and Spencer, T.
&quot;End-user Tools for Application Performance Analysis Using
Hardware Counters,” <I>International Conference on Parallel and
Distributed Computing Systems</I>, Dallas, TX, August 8-10, 2001.
<FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/papi/documents">http://icl.cs.utk.edu/papi/documents</A></U></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Mucci, P., Moore,
S., and Smeds, Nils. “Performance Tuning Using Hardware Counter
Data,” Proc. <I>SC’2001, </I>November 2001.
<FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/papi/documents">http://icl.cs.utk.edu/papi/documents</A></U></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Mucci, P. “The
IA64 Hardware Performance Monitor and PAPI”, <I>The 2001
International Conference on Parallel and Distributed Processing
Techniques and Applications, </I>June 2001.
<FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/papi/documents">http://icl.cs.utk.edu/papi/documents</A></U></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">Mucci, P. “PAPI --
The Performance Application Programming Interface,” April 2000.
<FONT COLOR="#0000ff"><U><A HREF="http://icl.cs.utk.edu/papi/documents">http://icl.cs.utk.edu/papi/documents</A></U></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in">“POSIX Threads
Programming.”
<FONT COLOR="#0000ff"><U><A HREF="http://www.llnl.gov/computing/tutorials/workshops/workshop/pthreads/MAIN.html">http://www.llnl.gov/computing/tutorials/workshops/workshop/pthreads/MAIN.html</A></U></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0.19in"><BR><BR>
</P>
<DIV TYPE=FOOTER>
	<P STYLE="margin-top: 0.21in; margin-bottom: 0.19in">	- <SDFIELD TYPE=PAGE SUBTYPE=RANDOM FORMAT=PAGE>1</SDFIELD>
	-</P>
</DIV>
</BODY>
</HTML>