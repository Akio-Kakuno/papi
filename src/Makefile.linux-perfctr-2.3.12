SUBSTR  = linux-perfctr
DESCR	= "Linux with PerfCtr patch for all Pentiums and the AMD K7"
LIBS	= static shared
TARGETS = multiplex serial pthreads 

CFLAGS  = -Wall -I./perfctr/usr.lib -DPERFCTR20 -I. -g
#-DDEBUG -DMPX_DEBUG -DMPX_DEBUG_TIMER
FFLAGS	= -Wall -g -Dlinux
OPTFLAGS= -O3 -mpentiumpro
FOPTFLAGS= $(OPTFLAGS)
CC	= gcc
F77	= g77
CC_SHR  = $(CC) -shared -Xlinker "-soname" -Xlinker "libpapi.so" -Xlinker "-rpath" -Xlinker "$(PWD)"
CC_R	= $(CC) -pthread
MISCOBJS= libperfctr.o
PERFCTR	= perfctr-2.3

include Makefile.inc

x86-events.h: perfctr
	cp ./$(PERFCTR)/etc/perfctr-events.tab > $@

libperfctr.o: perfctr
	cp ./$(PERFCTR)/usr.lib/libperfctr.o .

perfctr:
	$(MAKE) -C perfctr

clean-perfctr:
	$(MAKE) -C perfctr clean